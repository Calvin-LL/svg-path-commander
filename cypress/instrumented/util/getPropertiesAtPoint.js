function cov_9ddpvj3t6() {
  var path = "D:\\! At Work\\5OpenSource\\svg-path-commander\\src\\util\\getPropertiesAtPoint.js";
  var hash = "c7bc526320fbcfc5f144bd41c672ee8d65b1ff68";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "D:\\! At Work\\5OpenSource\\svg-path-commander\\src\\util\\getPropertiesAtPoint.js",
    statementMap: {
      "0": {
        start: {
          line: 18,
          column: 15
        },
        end: {
          line: 18,
          column: 50
        }
      },
      "1": {
        start: {
          line: 19,
          column: 21
        },
        end: {
          line: 19,
          column: 40
        }
      },
      "2": {
        start: {
          line: 20,
          column: 21
        },
        end: {
          line: 20,
          column: 41
        }
      },
      "3": {
        start: {
          line: 22,
          column: 21
        },
        end: {
          line: 26,
          column: 3
        }
      },
      "4": {
        start: {
          line: 23,
          column: 15
        },
        end: {
          line: 23,
          column: 28
        }
      },
      "5": {
        start: {
          line: 24,
          column: 15
        },
        end: {
          line: 24,
          column: 28
        }
      },
      "6": {
        start: {
          line: 25,
          column: 4
        },
        end: {
          line: 25,
          column: 29
        }
      },
      "7": {
        start: {
          line: 27,
          column: 18
        },
        end: {
          line: 27,
          column: 19
        }
      },
      "8": {
        start: {
          line: 28,
          column: 13
        },
        end: {
          line: 28,
          column: 27
        }
      },
      "9": {
        start: {
          line: 29,
          column: 21
        },
        end: {
          line: 29,
          column: 22
        }
      },
      "10": {
        start: {
          line: 30,
          column: 16
        },
        end: {
          line: 30,
          column: 20
        }
      },
      "11": {
        start: {
          line: 31,
          column: 19
        },
        end: {
          line: 31,
          column: 20
        }
      },
      "12": {
        start: {
          line: 32,
          column: 21
        },
        end: {
          line: 32,
          column: 29
        }
      },
      "13": {
        start: {
          line: 35,
          column: 2
        },
        end: {
          line: 43,
          column: 3
        }
      },
      "14": {
        start: {
          line: 35,
          column: 24
        },
        end: {
          line: 35,
          column: 25
        }
      },
      "15": {
        start: {
          line: 36,
          column: 4
        },
        end: {
          line: 36,
          column: 52
        }
      },
      "16": {
        start: {
          line: 37,
          column: 4
        },
        end: {
          line: 37,
          column: 36
        }
      },
      "17": {
        start: {
          line: 38,
          column: 4
        },
        end: {
          line: 42,
          column: 5
        }
      },
      "18": {
        start: {
          line: 39,
          column: 6
        },
        end: {
          line: 39,
          column: 21
        }
      },
      "19": {
        start: {
          line: 40,
          column: 6
        },
        end: {
          line: 40,
          column: 30
        }
      },
      "20": {
        start: {
          line: 41,
          column: 6
        },
        end: {
          line: 41,
          column: 34
        }
      },
      "21": {
        start: {
          line: 46,
          column: 2
        },
        end: {
          line: 46,
          column: 17
        }
      },
      "22": {
        start: {
          line: 47,
          column: 15
        },
        end: {
          line: 47,
          column: 29
        }
      },
      "23": {
        start: {
          line: 48,
          column: 14
        },
        end: {
          line: 48,
          column: 20
        }
      },
      "24": {
        start: {
          line: 49,
          column: 21
        },
        end: {
          line: 49,
          column: 22
        }
      },
      "25": {
        start: {
          line: 50,
          column: 20
        },
        end: {
          line: 50,
          column: 21
        }
      },
      "26": {
        start: {
          line: 51,
          column: 23
        },
        end: {
          line: 51,
          column: 24
        }
      },
      "27": {
        start: {
          line: 52,
          column: 22
        },
        end: {
          line: 52,
          column: 23
        }
      },
      "28": {
        start: {
          line: 54,
          column: 2
        },
        end: {
          line: 72,
          column: 3
        }
      },
      "29": {
        start: {
          line: 55,
          column: 4
        },
        end: {
          line: 55,
          column: 42
        }
      },
      "30": {
        start: {
          line: 56,
          column: 4
        },
        end: {
          line: 56,
          column: 56
        }
      },
      "31": {
        start: {
          line: 57,
          column: 4
        },
        end: {
          line: 57,
          column: 40
        }
      },
      "32": {
        start: {
          line: 58,
          column: 4
        },
        end: {
          line: 58,
          column: 41
        }
      },
      "33": {
        start: {
          line: 59,
          column: 4
        },
        end: {
          line: 59,
          column: 54
        }
      },
      "34": {
        start: {
          line: 60,
          column: 4
        },
        end: {
          line: 60,
          column: 38
        }
      },
      "35": {
        start: {
          line: 61,
          column: 4
        },
        end: {
          line: 71,
          column: 5
        }
      },
      "36": {
        start: {
          line: 62,
          column: 6
        },
        end: {
          line: 62,
          column: 23
        }
      },
      "37": {
        start: {
          line: 63,
          column: 6
        },
        end: {
          line: 63,
          column: 32
        }
      },
      "38": {
        start: {
          line: 64,
          column: 6
        },
        end: {
          line: 64,
          column: 36
        }
      },
      "39": {
        start: {
          line: 65,
          column: 11
        },
        end: {
          line: 71,
          column: 5
        }
      },
      "40": {
        start: {
          line: 66,
          column: 6
        },
        end: {
          line: 66,
          column: 22
        }
      },
      "41": {
        start: {
          line: 67,
          column: 6
        },
        end: {
          line: 67,
          column: 31
        }
      },
      "42": {
        start: {
          line: 68,
          column: 6
        },
        end: {
          line: 68,
          column: 35
        }
      },
      "43": {
        start: {
          line: 70,
          column: 6
        },
        end: {
          line: 70,
          column: 21
        }
      },
      "44": {
        start: {
          line: 74,
          column: 18
        },
        end: {
          line: 74,
          column: 57
        }
      },
      "45": {
        start: {
          line: 75,
          column: 19
        },
        end: {
          line: 75,
          column: 42
        }
      },
      "46": {
        start: {
          line: 77,
          column: 2
        },
        end: {
          line: 77,
          column: 40
        }
      }
    },
    fnMap: {
      "0": {
        name: "getPropertiesAtPoint",
        decl: {
          start: {
            line: 17,
            column: 24
          },
          end: {
            line: 17,
            column: 44
          }
        },
        loc: {
          start: {
            line: 17,
            column: 63
          },
          end: {
            line: 78,
            column: 1
          }
        },
        line: 17
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 22,
            column: 21
          },
          end: {
            line: 22,
            column: 22
          }
        },
        loc: {
          start: {
            line: 22,
            column: 28
          },
          end: {
            line: 26,
            column: 3
          }
        },
        line: 22
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 38,
            column: 4
          },
          end: {
            line: 42,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 38,
            column: 4
          },
          end: {
            line: 42,
            column: 5
          }
        }, {
          start: {
            line: 38,
            column: 4
          },
          end: {
            line: 42,
            column: 5
          }
        }],
        line: 38
      },
      "1": {
        loc: {
          start: {
            line: 61,
            column: 4
          },
          end: {
            line: 71,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 61,
            column: 4
          },
          end: {
            line: 71,
            column: 5
          }
        }, {
          start: {
            line: 61,
            column: 4
          },
          end: {
            line: 71,
            column: 5
          }
        }],
        line: 61
      },
      "2": {
        loc: {
          start: {
            line: 61,
            column: 8
          },
          end: {
            line: 61,
            column: 58
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 61,
            column: 8
          },
          end: {
            line: 61,
            column: 25
          }
        }, {
          start: {
            line: 61,
            column: 29
          },
          end: {
            line: 61,
            column: 58
          }
        }],
        line: 61
      },
      "3": {
        loc: {
          start: {
            line: 65,
            column: 11
          },
          end: {
            line: 71,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 65,
            column: 11
          },
          end: {
            line: 71,
            column: 5
          }
        }, {
          start: {
            line: 65,
            column: 11
          },
          end: {
            line: 71,
            column: 5
          }
        }],
        line: 65
      },
      "4": {
        loc: {
          start: {
            line: 65,
            column: 15
          },
          end: {
            line: 65,
            column: 72
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 65,
            column: 15
          },
          end: {
            line: 65,
            column: 40
          }
        }, {
          start: {
            line: 65,
            column: 44
          },
          end: {
            line: 65,
            column: 72
          }
        }],
        line: 65
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0
    },
    f: {
      "0": 0,
      "1": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "c7bc526320fbcfc5f144bd41c672ee8d65b1ff68"
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }

  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_9ddpvj3t6 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}

cov_9ddpvj3t6();
import getPointAtLength from './getPointAtLength';
import getPropertiesAtLength from './getPropertiesAtLength';
import getTotalLength from './getTotalLength';
import parsePathString from '../parser/parsePathString';
import fixPath from '../process/fixPath';
import normalizePath from '../process/normalizePath';
/**
 * Returns the point and segment in path closest to a given point as well as
 * the distance to the path stroke.
 * @see https://bl.ocks.org/mbostock/8027637
 *
 * @param {string | SVGPath.pathArray} pathInput target `pathArray`
 * @param {{x: number, y: number}} point the given point
 * @returns {SVGPath.pointProperties} the requested properties
 */

export default function getPropertiesAtPoint(pathInput, point) {
  cov_9ddpvj3t6().f[0]++;
  const path = (cov_9ddpvj3t6().s[0]++, fixPath(parsePathString(pathInput)));
  const normalPath = (cov_9ddpvj3t6().s[1]++, normalizePath(path));
  const pathLength = (cov_9ddpvj3t6().s[2]++, getTotalLength(path));
  /** @param {{x: number, y: number}} p */

  cov_9ddpvj3t6().s[3]++;

  const distanceTo = p => {
    cov_9ddpvj3t6().f[1]++;
    const dx = (cov_9ddpvj3t6().s[4]++, p.x - point.x);
    const dy = (cov_9ddpvj3t6().s[5]++, p.y - point.y);
    cov_9ddpvj3t6().s[6]++;
    return dx * dx + dy * dy;
  };

  let precision = (cov_9ddpvj3t6().s[7]++, 8);
  let scan = (cov_9ddpvj3t6().s[8]++, {
    x: 0,
    y: 0
  });
  let scanDistance = (cov_9ddpvj3t6().s[9]++, 0);
  let closest = (cov_9ddpvj3t6().s[10]++, scan);
  let bestLength = (cov_9ddpvj3t6().s[11]++, 0);
  let bestDistance = (cov_9ddpvj3t6().s[12]++, Infinity); // linear scan for coarse approximation

  cov_9ddpvj3t6().s[13]++;

  for (let scanLength = (cov_9ddpvj3t6().s[14]++, 0); scanLength <= pathLength; scanLength += precision) {
    cov_9ddpvj3t6().s[15]++;
    scan = getPointAtLength(normalPath, scanLength);
    cov_9ddpvj3t6().s[16]++;
    scanDistance = distanceTo(scan);
    cov_9ddpvj3t6().s[17]++;

    if (scanDistance < bestDistance) {
      cov_9ddpvj3t6().b[0][0]++;
      cov_9ddpvj3t6().s[18]++;
      closest = scan;
      cov_9ddpvj3t6().s[19]++;
      bestLength = scanLength;
      cov_9ddpvj3t6().s[20]++;
      bestDistance = scanDistance;
    } else {
      cov_9ddpvj3t6().b[0][1]++;
    }
  } // binary search for precise estimate


  cov_9ddpvj3t6().s[21]++;
  precision /= 2;
  let before = (cov_9ddpvj3t6().s[22]++, {
    x: 0,
    y: 0
  });
  let after = (cov_9ddpvj3t6().s[23]++, before);
  let beforeLength = (cov_9ddpvj3t6().s[24]++, 0);
  let afterLength = (cov_9ddpvj3t6().s[25]++, 0);
  let beforeDistance = (cov_9ddpvj3t6().s[26]++, 0);
  let afterDistance = (cov_9ddpvj3t6().s[27]++, 0);
  cov_9ddpvj3t6().s[28]++;

  while (precision > 0.5) {
    cov_9ddpvj3t6().s[29]++;
    beforeLength = bestLength - precision;
    cov_9ddpvj3t6().s[30]++;
    before = getPointAtLength(normalPath, beforeLength);
    cov_9ddpvj3t6().s[31]++;
    beforeDistance = distanceTo(before);
    cov_9ddpvj3t6().s[32]++;
    afterLength = bestLength + precision;
    cov_9ddpvj3t6().s[33]++;
    after = getPointAtLength(normalPath, afterLength);
    cov_9ddpvj3t6().s[34]++;
    afterDistance = distanceTo(after);
    cov_9ddpvj3t6().s[35]++;

    if ((cov_9ddpvj3t6().b[2][0]++, beforeLength >= 0) && (cov_9ddpvj3t6().b[2][1]++, beforeDistance < bestDistance)) {
      cov_9ddpvj3t6().b[1][0]++;
      cov_9ddpvj3t6().s[36]++;
      closest = before;
      cov_9ddpvj3t6().s[37]++;
      bestLength = beforeLength;
      cov_9ddpvj3t6().s[38]++;
      bestDistance = beforeDistance;
    } else {
      cov_9ddpvj3t6().b[1][1]++;
      cov_9ddpvj3t6().s[39]++;

      if ((cov_9ddpvj3t6().b[4][0]++, afterLength <= pathLength) && (cov_9ddpvj3t6().b[4][1]++, afterDistance < bestDistance)) {
        cov_9ddpvj3t6().b[3][0]++;
        cov_9ddpvj3t6().s[40]++;
        closest = after;
        cov_9ddpvj3t6().s[41]++;
        bestLength = afterLength;
        cov_9ddpvj3t6().s[42]++;
        bestDistance = afterDistance;
      } else {
        cov_9ddpvj3t6().b[3][1]++;
        cov_9ddpvj3t6().s[43]++;
        precision /= 2;
      }
    }
  }

  const segment = (cov_9ddpvj3t6().s[44]++, getPropertiesAtLength(path, bestLength));
  const distance = (cov_9ddpvj3t6().s[45]++, Math.sqrt(bestDistance));
  cov_9ddpvj3t6().s[46]++;
  return {
    closest,
    distance,
    segment
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldFByb3BlcnRpZXNBdFBvaW50LmpzIl0sIm5hbWVzIjpbImdldFBvaW50QXRMZW5ndGgiLCJnZXRQcm9wZXJ0aWVzQXRMZW5ndGgiLCJnZXRUb3RhbExlbmd0aCIsInBhcnNlUGF0aFN0cmluZyIsImZpeFBhdGgiLCJub3JtYWxpemVQYXRoIiwiZ2V0UHJvcGVydGllc0F0UG9pbnQiLCJwYXRoSW5wdXQiLCJwb2ludCIsInBhdGgiLCJub3JtYWxQYXRoIiwicGF0aExlbmd0aCIsImRpc3RhbmNlVG8iLCJwIiwiZHgiLCJ4IiwiZHkiLCJ5IiwicHJlY2lzaW9uIiwic2NhbiIsInNjYW5EaXN0YW5jZSIsImNsb3Nlc3QiLCJiZXN0TGVuZ3RoIiwiYmVzdERpc3RhbmNlIiwiSW5maW5pdHkiLCJzY2FuTGVuZ3RoIiwiYmVmb3JlIiwiYWZ0ZXIiLCJiZWZvcmVMZW5ndGgiLCJhZnRlckxlbmd0aCIsImJlZm9yZURpc3RhbmNlIiwiYWZ0ZXJEaXN0YW5jZSIsInNlZ21lbnQiLCJkaXN0YW5jZSIsIk1hdGgiLCJzcXJ0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QUFBQTtBQUFBO0FBQ3BFRixRQUFBQSxPQUFPLEdBQUdNLEtBQVY7QUFEb0U7QUFFcEVMLFFBQUFBLFVBQVUsR0FBR08sV0FBYjtBQUZvRTtBQUdwRU4sUUFBQUEsWUFBWSxHQUFHUSxhQUFmO0FBQ0QsT0FKTSxNQUlBO0FBQUE7QUFBQTtBQUNMYixRQUFBQSxTQUFTLElBQUksQ0FBYjtBQUNEO0FBQUE7QUFDRjs7QUFFRCxRQUFNYyxPQUFPLDZCQUFHL0IscUJBQXFCLENBQUNRLElBQUQsRUFBT2EsVUFBUCxDQUF4QixDQUFiO0FBQ0EsUUFBTVcsUUFBUSw2QkFBR0MsSUFBSSxDQUFDQyxJQUFMLENBQVVaLFlBQVYsQ0FBSCxDQUFkO0FBMUQ2RDtBQTREN0QsU0FBTztBQUFFRixJQUFBQSxPQUFGO0FBQVdZLElBQUFBLFFBQVg7QUFBcUJELElBQUFBO0FBQXJCLEdBQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBnZXRQb2ludEF0TGVuZ3RoIGZyb20gJy4vZ2V0UG9pbnRBdExlbmd0aCc7XG5pbXBvcnQgZ2V0UHJvcGVydGllc0F0TGVuZ3RoIGZyb20gJy4vZ2V0UHJvcGVydGllc0F0TGVuZ3RoJztcbmltcG9ydCBnZXRUb3RhbExlbmd0aCBmcm9tICcuL2dldFRvdGFsTGVuZ3RoJztcbmltcG9ydCBwYXJzZVBhdGhTdHJpbmcgZnJvbSAnLi4vcGFyc2VyL3BhcnNlUGF0aFN0cmluZyc7XG5pbXBvcnQgZml4UGF0aCBmcm9tICcuLi9wcm9jZXNzL2ZpeFBhdGgnO1xuaW1wb3J0IG5vcm1hbGl6ZVBhdGggZnJvbSAnLi4vcHJvY2Vzcy9ub3JtYWxpemVQYXRoJztcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBwb2ludCBhbmQgc2VnbWVudCBpbiBwYXRoIGNsb3Nlc3QgdG8gYSBnaXZlbiBwb2ludCBhcyB3ZWxsIGFzXG4gKiB0aGUgZGlzdGFuY2UgdG8gdGhlIHBhdGggc3Ryb2tlLlxuICogQHNlZSBodHRwczovL2JsLm9ja3Mub3JnL21ib3N0b2NrLzgwMjc2MzdcbiAqXG4gKiBAcGFyYW0ge3N0cmluZyB8IFNWR1BhdGgucGF0aEFycmF5fSBwYXRoSW5wdXQgdGFyZ2V0IGBwYXRoQXJyYXlgXG4gKiBAcGFyYW0ge3t4OiBudW1iZXIsIHk6IG51bWJlcn19IHBvaW50IHRoZSBnaXZlbiBwb2ludFxuICogQHJldHVybnMge1NWR1BhdGgucG9pbnRQcm9wZXJ0aWVzfSB0aGUgcmVxdWVzdGVkIHByb3BlcnRpZXNcbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0UHJvcGVydGllc0F0UG9pbnQocGF0aElucHV0LCBwb2ludCkge1xuICBjb25zdCBwYXRoID0gZml4UGF0aChwYXJzZVBhdGhTdHJpbmcocGF0aElucHV0KSk7XG4gIGNvbnN0IG5vcm1hbFBhdGggPSBub3JtYWxpemVQYXRoKHBhdGgpO1xuICBjb25zdCBwYXRoTGVuZ3RoID0gZ2V0VG90YWxMZW5ndGgocGF0aCk7XG4gIC8qKiBAcGFyYW0ge3t4OiBudW1iZXIsIHk6IG51bWJlcn19IHAgKi9cbiAgY29uc3QgZGlzdGFuY2VUbyA9IChwKSA9PiB7XG4gICAgY29uc3QgZHggPSBwLnggLSBwb2ludC54O1xuICAgIGNvbnN0IGR5ID0gcC55IC0gcG9pbnQueTtcbiAgICByZXR1cm4gZHggKiBkeCArIGR5ICogZHk7XG4gIH07XG4gIGxldCBwcmVjaXNpb24gPSA4O1xuICBsZXQgc2NhbiA9IHsgeDogMCwgeTogMCB9O1xuICBsZXQgc2NhbkRpc3RhbmNlID0gMDtcbiAgbGV0IGNsb3Nlc3QgPSBzY2FuO1xuICBsZXQgYmVzdExlbmd0aCA9IDA7XG4gIGxldCBiZXN0RGlzdGFuY2UgPSBJbmZpbml0eTtcblxuICAvLyBsaW5lYXIgc2NhbiBmb3IgY29hcnNlIGFwcHJveGltYXRpb25cbiAgZm9yIChsZXQgc2Nhbkxlbmd0aCA9IDA7IHNjYW5MZW5ndGggPD0gcGF0aExlbmd0aDsgc2Nhbkxlbmd0aCArPSBwcmVjaXNpb24pIHtcbiAgICBzY2FuID0gZ2V0UG9pbnRBdExlbmd0aChub3JtYWxQYXRoLCBzY2FuTGVuZ3RoKTtcbiAgICBzY2FuRGlzdGFuY2UgPSBkaXN0YW5jZVRvKHNjYW4pO1xuICAgIGlmIChzY2FuRGlzdGFuY2UgPCBiZXN0RGlzdGFuY2UpIHtcbiAgICAgIGNsb3Nlc3QgPSBzY2FuO1xuICAgICAgYmVzdExlbmd0aCA9IHNjYW5MZW5ndGg7XG4gICAgICBiZXN0RGlzdGFuY2UgPSBzY2FuRGlzdGFuY2U7XG4gICAgfVxuICB9XG5cbiAgLy8gYmluYXJ5IHNlYXJjaCBmb3IgcHJlY2lzZSBlc3RpbWF0ZVxuICBwcmVjaXNpb24gLz0gMjtcbiAgbGV0IGJlZm9yZSA9IHsgeDogMCwgeTogMCB9O1xuICBsZXQgYWZ0ZXIgPSBiZWZvcmU7XG4gIGxldCBiZWZvcmVMZW5ndGggPSAwO1xuICBsZXQgYWZ0ZXJMZW5ndGggPSAwO1xuICBsZXQgYmVmb3JlRGlzdGFuY2UgPSAwO1xuICBsZXQgYWZ0ZXJEaXN0YW5jZSA9IDA7XG5cbiAgd2hpbGUgKHByZWNpc2lvbiA+IDAuNSkge1xuICAgIGJlZm9yZUxlbmd0aCA9IGJlc3RMZW5ndGggLSBwcmVjaXNpb247XG4gICAgYmVmb3JlID0gZ2V0UG9pbnRBdExlbmd0aChub3JtYWxQYXRoLCBiZWZvcmVMZW5ndGgpO1xuICAgIGJlZm9yZURpc3RhbmNlID0gZGlzdGFuY2VUbyhiZWZvcmUpO1xuICAgIGFmdGVyTGVuZ3RoID0gYmVzdExlbmd0aCArIHByZWNpc2lvbjtcbiAgICBhZnRlciA9IGdldFBvaW50QXRMZW5ndGgobm9ybWFsUGF0aCwgYWZ0ZXJMZW5ndGgpO1xuICAgIGFmdGVyRGlzdGFuY2UgPSBkaXN0YW5jZVRvKGFmdGVyKTtcbiAgICBpZiAoYmVmb3JlTGVuZ3RoID49IDAgJiYgYmVmb3JlRGlzdGFuY2UgPCBiZXN0RGlzdGFuY2UpIHtcbiAgICAgIGNsb3Nlc3QgPSBiZWZvcmU7XG4gICAgICBiZXN0TGVuZ3RoID0gYmVmb3JlTGVuZ3RoO1xuICAgICAgYmVzdERpc3RhbmNlID0gYmVmb3JlRGlzdGFuY2U7XG4gICAgfSBlbHNlIGlmIChhZnRlckxlbmd0aCA8PSBwYXRoTGVuZ3RoICYmIGFmdGVyRGlzdGFuY2UgPCBiZXN0RGlzdGFuY2UpIHtcbiAgICAgIGNsb3Nlc3QgPSBhZnRlcjtcbiAgICAgIGJlc3RMZW5ndGggPSBhZnRlckxlbmd0aDtcbiAgICAgIGJlc3REaXN0YW5jZSA9IGFmdGVyRGlzdGFuY2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByZWNpc2lvbiAvPSAyO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHNlZ21lbnQgPSBnZXRQcm9wZXJ0aWVzQXRMZW5ndGgocGF0aCwgYmVzdExlbmd0aCk7XG4gIGNvbnN0IGRpc3RhbmNlID0gTWF0aC5zcXJ0KGJlc3REaXN0YW5jZSk7XG5cbiAgcmV0dXJuIHsgY2xvc2VzdCwgZGlzdGFuY2UsIHNlZ21lbnQgfTtcbn1cbiJdfQ==