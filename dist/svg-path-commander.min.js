// SVGPathCommander v0.0.6b | thednp Â© 2020 | MIT-License
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).SVGPathCommander=t()}(this,(function(){"use strict";var e={decimals:3,round:1};function t(e){return e.map((function(e){return Array.isArray(e)?t(e):isNaN(+e)?e:+e}))}function n(n,a){var r=isNaN(+a)?e.round&&e.decimals:+a;return r?n.map((function(e){return e.map((function(e,t){var n=+e,a=Math.pow(10,r);return t?n%1==0?n:Math.round(n*a)/a:e}))})):t(n)}function a(e){return this.segments=[],this.pathValue=e,this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err="",this}var r={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function i(e){var t=e.pathValue[e.segmentStart],n=t.toLowerCase(),a=e.data;if("m"===n&&a.length>2&&(e.segments.push([t,a[0],a[1]]),a=a.slice(2),n="l",t="m"===t?"l":"L"),"r"===n)e.segments.push([t].concat(a));else for(;a.length>=r[n]&&(e.segments.push([t].concat(a.splice(0,r[n]))),r[n]););}function s(e){var t=e.pathValue.charCodeAt(e.index);return 48===t?(e.param=0,void e.index++):49===t?(e.param=1,void e.index++):void(e.err="Invalid path value")}function c(e){return e>=48&&e<=57}function u(e){var t,n=e.index,a=n,r=e.max,i=!1,s=!1,u=!1,o=!1;if(a>=r)e.err="Invalid path value: missing param "+e.pathValue[a];else if(43!==(t=e.pathValue.charCodeAt(a))&&45!==t||(t=++a<r?e.pathValue.charCodeAt(a):0),c(t)||46===t){if(46!==t){if(i=48===t,t=++a<r?e.pathValue.charCodeAt(a):0,i&&a<r&&t&&c(t))return void(e.err="Invalid path value: "+e.pathValue[n]+" illegal number");for(;a<r&&c(e.pathValue.charCodeAt(a));)a++,s=!0;t=a<r?e.pathValue.charCodeAt(a):0}if(46===t){for(o=!0,a++;c(e.pathValue.charCodeAt(a));)a++,u=!0;t=a<r?e.pathValue.charCodeAt(a):0}if(101===t||69===t){if(o&&!s&&!u)return void(e.err="Invalid path value: "+e.pathValue[a]+" invalid float exponent");if(43!==(t=++a<r?e.pathValue.charCodeAt(a):0)&&45!==t||a++,!(a<r&&c(e.pathValue.charCodeAt(a))))return void(e.err="Invalid path value: "+e.pathValue[a]+" invalid float exponent");for(;a<r&&c(e.pathValue.charCodeAt(a));)a++}e.index=a,e.param=+e.pathValue.slice(n,a)}else e.err="Invalid path value: "+e.pathValue[a]+" not number"}function o(e){return e>=48&&e<=57||43===e||45===e||46===e}function h(e){for(;e.index<e.max&&(10===(t=e.pathValue.charCodeAt(e.index))||13===t||8232===t||8233===t||32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0);)e.index++;var t}function l(e){var t,n,a,c,l=e.max;if(e.segmentStart=e.index,function(e){switch(32|e){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}(t=e.pathValue.charCodeAt(e.index)))if(a=r[e.pathValue[e.index].toLowerCase()],e.index++,h(e),e.data=[],a){for(n=!1;;){for(c=a;c>0;c--){if(97!=(32|t)||3!==c&&4!==c?u(e):s(e),e.err.length)return;e.data.push(e.param),h(e),n=!1,e.index<l&&44===e.pathValue.charCodeAt(e.index)&&(e.index++,h(e),n=!0)}if(!n){if(e.index>=e.max)break;if(!o(e.pathValue.charCodeAt(e.index)))break}}i(e)}else i(e);else e.err="Invalid path value: "+e.pathValue[e.index]+" not a path command"}function f(e){return Array.isArray(e)&&e.every((function(e){var t=e[0].toLowerCase();return r[t]===e.length-1&&/[achlmrqstvz]/g.test(t)}))}function p(e,r){if(f(e))return t(e);var i=new a(e),s=i.max;for(h(i);i.index<s&&!i.err.length;)l(i);return i.err.length?i.segments=[]:i.segments.length&&("mM".indexOf(i.segments[0][0])<0?(i.err="Invalid path value: missing M/m",i.segments=[]):i.segments[0][0]="M"),n(i.segments,r)}function d(e){return f(e)&&e.every((function(e){return e[0]===e[0].toUpperCase()}))}function m(e,a){if(d(e))return t(e);e=p(e);var r=[],i=0,s=0,c=0,u=0,o=0,h=e.length,l="",f=[],m=0,x=[];"M"===e[0][0]&&(i=+e[0][1],s=+e[0][2],c=i,u=s,o++,r[0]=["M",i,s]);for(var v=o;v<h;v++){if(l=(f=e[v])[0],r.push(x=[]),l!==l.toUpperCase())switch(x[0]=l.toUpperCase(),x[0]){case"A":f.slice(1,-2).concat([+f[6]+i,+f[7]+s]).map((function(e){return x.push(e)}));break;case"V":x[1]=+f[1]+s;break;case"H":x[1]=+f[1]+i;break;case"M":c=+f[1]+i,u=+f[2]+s;default:f.map((function(e,t){return t&&x.push(+e+(t%2?i:s))}))}else f.map((function(e){return x.push(e)}));switch(m=x.length,x[0]){case"Z":i=c,s=u;break;case"H":i=+x[1];break;case"V":s=+x[1];break;case"M":c=+x[m-2],u=+x[m-1];default:i=+x[m-2],s=+x[m-1]}}return n(r,a)}function x(e){return f(e)&&e.slice(1).every((function(e){return e[0]===e[0].toLowerCase()}))}function v(e,a){if(x(e))return t(e);e=p(e);var r=[],i=0,s=0,c=0,u=0,o=0,h=[],l="",f=[],d=0,m=e.length;"M"===e[0][0]&&(s=+e[0][1],c=+e[0][2],u=s,o=c,d++,r.push(["M",s,c]));for(var v=function(t){if(h=e[t],l=h[0],r.push(f=[]),l!==l.toLowerCase())switch(f[0]=l.toLowerCase(),f[0]){case"a":h.slice(1,-2).concat([+h[6]-s,+h[7]-c]).map((function(e){return f.push(e)}));break;case"v":f[1]=+h[1]-c;break;case"m":u=+h[1],o=+h[2];default:h.map((function(e,t){return t&&f.push(+e-(t%2?s:c))}))}else f=[],r[t]=f,"m"===l&&(u=+h[1]+s,o=+h[2]+c),h.map((function(e){return r[t].push(e)}));switch(i=r[t].length,r[t][0]){case"z":s=u,c=o;break;case"h":s+=r[t][i-1];break;case"v":c+=r[t][i-1];break;default:s+=r[t][i-2],c+=r[t][i-1]}},g=d;g<m;g++)v(g);return n(r,a)}function g(e){return e.map((function(e){return e[0].concat(e.slice(1).join(" "))})).join("")}function y(e,t,n){var a,r;switch(e[0]){case"S":r=function(e,t,n,a,r){return"CS".indexOf(r)>-1?{x1:2*e-n,y1:2*t-a}:{x1:e,y1:t}}(t.x1,t.y1,t.x2,t.y2,n),t.x1=r.x1,t.y1=r.y1,e=["C",r.x1,r.y1].concat(e.slice(1));break;case"T":a=function(e,t,n,a,r){return"QT".indexOf(r)>-1?{qx:2*e-n,qy:2*t-a}:{qx:e,qy:t}}(t.x1,t.y1,t.qx,t.qy,n),t.qx=a.qx,t.qy=a.qy,e=["Q",t.qx,t.qy].concat(e.slice(1));break;case"Q":t.qx=e[1],t.qy=e[2];break;case"H":e=["L",e[1],t.y1];break;case"V":e=["L",t.x1,e[1]]}return e}function C(e,t){for(var a,r,i={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},s=[],c="",u="",o=(e=m(e)).length,h=0;h<o;h++)e[h]&&(c=e[h][0]),s[h]=c,h&&(u=s[h-1]),e[h]=y(e[h],i,u),r=(a=e[h]).length,i.x1=+a[r-2],i.y1=+a[r-1],i.x2=+a[r-4]||i.x1,i.y2=+a[r-3]||i.y1;return n(e,t)}function b(e,t){var n=m(e,t),a="Z"===n.slice(-1)[0][0],r=[],i=0;return r=C(n).map((function(e,t){return i=e.length,{c:n[t][0],x:e[i-2],y:e[i-1],seg:n[t],normSeg:e}})).map((function(e,t,n){var r=e.seg,i=e.normSeg,s=t&&n[t-1],c=n[t+1]&&n[t+1],u=e.c,o=n.length,h=t?n[t-1].x:n[o-1].x,l=t?n[t-1].y:n[o-1].y,f=[];switch(u){case"M":f=a?["Z"]:[u,h,l];break;case"A":f=r.slice(0,-3).concat([1===r[5]?0:1,h,l]);break;case"C":f=c&&"S"===c.c?["S",r[1],r[2],h,l]:[u,r[3],r[4],r[1],r[2],h,l];break;case"S":f=s&&"CS".indexOf(s.c)>-1&&(!c||c&&"S"!==c.c)?["C",i[3],i[4],i[1],i[2],h,l]:[u,i[1],i[2],h,l];break;case"Q":f=c&&"T"===c.c?["T",h,l]:r.slice(0,-2).concat([h,l]);break;case"T":f=s&&"QT".indexOf(s.c)>-1&&(!c||c&&"T"!==c.c)?["Q",i[1],i[2],h,l]:[u,h,l];break;case"Z":f=["M",h,l];break;case"H":f=[u,h];break;case"V":f=[u,l];break;default:f=r.slice(0,-2).concat([h,l])}return f})),a?r.reverse():[r[0]].concat(r.slice(1).reverse())}function M(e){return e.replace(/(m|M)/g,"|$1").split("|").map((function(e){return e.trim()})).filter((function(e){return e}))}function A(e,t){var n=m(e,t),a=v(e,t);return n.map((function(e,t){return t?e.join("").length<a[t].join("").length?e:a[t]:e}))}var V=function(n,a){this.round=a&&0===a.round?0:a&&a.decimals?a.decimals:e.round&&e.decimals?e.decimals:0;var r=p(n,this.round);return this.segments=t(r),this.pathValue=n,this};function k(e){return e.slice(1).map((function(e,t,n){var a,r,i,s,c,u,o,h,l,f=n[0===t?n.length-1:t-1];return a=f.slice(f.length-2).concat(e.slice(1)),r=a[0],i=a[1],s=a[2],c=a[3],u=a[4],o=a[5],h=a[6],3*(((l=a[7])-i)*(s+u)-(h-r)*(c+o)+c*(r-u)-s*(i-o)+l*(u+r/3)-h*(o+i/3))/20})).reduce((function(e,t){return e+t}),0)}function q(e){return f(e)&&e.slice(1).every((function(e){return"C"===e[0]}))}function w(e,t,n){if(e[n].length>7){e[n].shift();for(var a=e[n];a.length;)t[n]="A",e.splice(n++,0,["C"].concat(a.splice(0,6)));e.splice(n,1)}}function S(e,t,n){return{x:e*Math.cos(n)-t*Math.sin(n),y:e*Math.sin(n)+t*Math.cos(n)}}function P(e,t,n,a,r,i,s,c,u,o){var h,l,f,p,d,m=120*Math.PI/180,x=Math.PI/180*(r||0),v=[];if(o)l=o[0],f=o[1],p=o[2],d=o[3];else{e=(h=S(e,t,-x)).x,t=h.y;var g=(e-(c=(h=S(c,u,-x)).x))/2,y=(t-(u=h.y))/2,C=g*g/(n*n)+y*y/(a*a);C>1&&(n*=C=Math.sqrt(C),a*=C);var b=n*n,M=a*a,A=(i==s?-1:1)*Math.sqrt(Math.abs((b*M-b*y*y-M*g*g)/(b*y*y+M*g*g)));p=A*n*y/a+(e+c)/2,d=A*-a*g/n+(t+u)/2,l=Math.asin(((t-d)/a).toFixed(9)),f=Math.asin(((u-d)/a).toFixed(9)),l=e<p?Math.PI-l:l,f=c<p?Math.PI-f:f,l<0&&(l=2*Math.PI+l),f<0&&(f=2*Math.PI+f),s&&l>f&&(l-=2*Math.PI),!s&&f>l&&(f-=2*Math.PI)}var V=f-l;if(Math.abs(V)>m){var k=f,q=c,w=u;f=l+m*(s&&f>l?1:-1),c=p+n*Math.cos(f),u=d+a*Math.sin(f),v=P(c,u,n,a,r,0,s,q,w,[f,k,p,d])}V=f-l;var I=Math.cos(l),T=Math.sin(l),L=Math.cos(f),Q=Math.sin(f),z=Math.tan(V/4),O=4/3*n*z,j=4/3*a*z,Z=[e,t],D=[e+O*T,t-j*I],H=[c+O*Q,u-j*L],N=[c,u];return D[0]=2*Z[0]-D[0],D[1]=2*Z[1]-D[1],o?[D,H,N].concat(v):(v=[D,H,N].concat(v).join().split(",")).map((function(e,t){return t%2?S(v[t-1],e,x).y:S(e,v[t+1],x).x}))}function I(e,t,n,a,r,i){return[1/3*e+2/3*n,1/3*t+2/3*a,1/3*r+2/3*n,1/3*i+2/3*a,r,i]}function T(e,t,n,a){return[e,t,n,a,n,a]}function L(e,t){switch("TQ".indexOf(e[0])<0&&(t.qx=t.qy=null),e[0]){case"M":t.x=e[1],t.y=e[2];break;case"A":e=["C"].concat(P.apply(0,[t.x1,t.y1].concat(e.slice(1))));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(I.apply(0,[t.x1,t.y1].concat(e.slice(1))));break;case"L":e=["C"].concat(T(t.x1,t.y1,e[1],e[2]));break;case"Z":e=["C"].concat(T(t.x1,t.y1,t.x,t.y))}return e}V.prototype.toAbsolute=function(){var e=m(this.segments,this.round);return this.segments=t(e),this},V.prototype.toRelative=function(){var e=v(this.segments,this.round);return this.segments=t(e),this},V.prototype.reverse=function(e){this.toAbsolute();var n=M(this.pathValue).length>1&&M(this.toString()),a=n&&t(n).map((function(t,n){return e?n?b(t):p(t):b(t)})),r=n?[].concat.apply([],a):e?this.segments:b(this.segments);return this.segments=t(r),this},V.prototype.normalize=function(){var e=C(this.segments,this.round);return this.segments=t(e),this},V.prototype.optimize=function(){var e=A(this.segments,this.round);return this.segments=t(e),this},V.prototype.toString=function(){return g(this.segments)};var Q={getShapeArea:k,getDrawDirection:function(e){if(!q(e))throw"getDrawDirection expects a curveArray";return k(e)>=0},clonePath:t,splitPath:M,isPathArray:f,isCurveArray:q,isAbsoluteArray:d,isRelativeArray:x,roundPath:n,optimizePath:A,pathToAbsolute:m,pathToRelative:v,pathToCurve:function(e,a){if(q(e))return t(e);for(var r,i,s={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},c=[],u="",o=(e=C(e)).length,h=0;h<o;h++)e[h]&&(u=e[h][0]),"C"!==u&&(c[h]=u),e[h]=L(e[h],s),"A"!==c[h]&&"C"===u&&(c[h]="C"),w(e,c,h),o=e.length,i=(r=e[h]).length,s.x1=+r[i-2],s.y1=+r[i-1],s.x2=+r[i-4]||s.x1,s.y2=+r[i-3]||s.y1;return n(e,a)},pathToString:g,parsePathString:p,reverseCurve:function(e){var t=e.slice(1).map((function(t,n,a){return n?a[n-1].slice(-2).concat(t.slice(1)):e[0].slice(1).concat(t.slice(1))})).map((function(e){return e.map((function(t,n){return e[e.length-n-2*(1-n%2)]}))})).reverse();return[["M"].concat(t[0].slice(0,2))].concat(t.map((function(e){return["C"].concat(e.slice(2))})))},reversePath:b,normalizePath:C,options:e};for(var z in Q)V[z]=Q[z];return V}));
