// SVGPathCommander v0.0.2 | thednp Â© 2020 | MIT-License
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).SVGPathCommander=t()}(this,(function(){"use strict";function e(t){return t.map((function(t){return Array.isArray(t)?e(t):isNaN(+t)?t:+t}))}var t={decimals:3,round:1};function a(a){return t.round?a.map((function(e){return e.map((function(e,a){var n=+e,r=Math.pow(10,t.decimals);return a?n%1==0?n:(n*r>>0)/r:e}))})):e(a)}function n(e){return this.segments=[],this.pathValue=e,this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err="",this}var r={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function i(e){var t=e.pathValue[e.segmentStart],a=t.toLowerCase(),n=e.data;if("m"===a&&n.length>2&&(e.segments.push([t,n[0],n[1]]),n=n.slice(2),a="l",t="m"===t?"l":"L"),"r"===a)e.segments.push([t].concat(n));else for(;n.length>=r[a]&&(e.segments.push([t].concat(n.splice(0,r[a]))),r[a]););}function s(e){var t=e.pathValue.charCodeAt(e.index);return 48===t?(e.param=0,void e.index++):49===t?(e.param=1,void e.index++):void(e.err="Invalid path value")}function c(e){return e>=48&&e<=57}function o(e){var t,a=e.index,n=a,r=e.max,i=!1,s=!1,o=!1,h=!1;if(n>=r)e.err="Invalid path value";else if(43!==(t=e.pathValue.charCodeAt(n))&&45!==t||(t=++n<r?e.pathValue.charCodeAt(n):0),c(t)||46===t){if(46!==t){if(i=48===t,t=++n<r?e.pathValue.charCodeAt(n):0,i&&n<r&&t&&c(t))return void(e.err="Invalid path value");for(;n<r&&c(e.pathValue.charCodeAt(n));)n++,s=!0;t=n<r?e.pathValue.charCodeAt(n):0}if(46===t){for(h=!0,n++;c(e.pathValue.charCodeAt(n));)n++,o=!0;t=n<r?e.pathValue.charCodeAt(n):0}if(101===t||69===t){if(h&&!s&&!o)return void(e.err="Invalid path value");if(43!==(t=++n<r?e.pathValue.charCodeAt(n):0)&&45!==t||n++,!(n<r&&c(e.pathValue.charCodeAt(n))))return void(e.err="Invalid path value");for(;n<r&&c(e.pathValue.charCodeAt(n));)n++}e.index=n,e.param=+e.pathValue.slice(a,n)}else e.err="Invalid path value"}function h(e){return e>=48&&e<=57||43===e||45===e||46===e}function u(e){for(;e.index<e.max&&(10===(t=e.pathValue.charCodeAt(e.index))||13===t||8232===t||8233===t||32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0);)e.index++;var t}function l(e){var t,a,n,c,l=e.max;if(e.segmentStart=e.index,function(e){switch(32|e){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}(t=e.pathValue.charCodeAt(e.index)))if(n=r[e.pathValue[e.index].toLowerCase()],e.index++,u(e),e.data=[],n){for(a=!1;;){for(c=n;c>0;c--){if(97!=(32|t)||3!==c&&4!==c?o(e):s(e),e.err.length)return;e.data.push(e.param),u(e),a=!1,e.index<l&&44===e.pathValue.charCodeAt(e.index)&&(e.index++,u(e),a=!0)}if(!a){if(e.index>=e.max)break;if(!h(e.pathValue.charCodeAt(e.index)))break}}i(e)}else i(e);else e.err="Invalid path value"}function f(t){if(Array.isArray(t)&&Array.isArray(t[0]))return e(t);var r=new n(t),i=r.max;for(u(r);r.index<i&&!r.err.length;)l(r);return r.err.length?r.segments=[]:r.segments.length&&("mM".indexOf(r.segments[0][0])<0?(r.err="Invalid path value",r.segments=[]):r.segments[0][0]="M"),a(r.segments)}function x(e,t){for(var a=[],n=0,r=e.length;r-2*!t>n;n+=2){var i=[{x:+e[n-2],y:+e[n-1]},{x:+e[n],y:+e[n+1]},{x:+e[n+2],y:+e[n+3]},{x:+e[n+4],y:+e[n+5]}];t?n?r-4==n?i[3]={x:+e[0],y:+e[1]}:r-2==n&&(i[2]={x:+e[0],y:+e[1]},i[3]={x:+e[2],y:+e[3]}):i[0]={x:+e[r-2],y:+e[r-1]}:r-4==n?i[3]=i[2]:n||(i[0]={x:+e[n],y:+e[n+1]}),a.push(["C",(-i[0].x+6*i[1].x+i[2].x)/6,(-i[0].y+6*i[1].y+i[2].y)/6,(i[1].x+6*i[2].x-i[3].x)/6,(i[1].y+6*i[2].y-i[3].y)/6,i[2].x,i[2].y])}return a}function g(e,t,a,n,r){var i;if(null==r&&null==n&&(n=a),e=+e,t=+t,a=+a,n=+n,null!=r){var s=Math.PI/180,c=e+a*Math.cos(-n*s),o=e+a*Math.cos(-r*s);i=[["M",c,t+a*Math.sin(-n*s)],["A",a,a,0,+(r-n>180),0,o,t+a*Math.sin(-r*s)]]}else i=[["M",e,t],["m",0,-n],["a",a,n,0,1,1,0,2*n],["a",a,n,0,1,1,0,-2*n],["z"]];return i}function v(e){if(!(e=f(e))||!e.length)return[["M",0,0]];var t=[],n=0,r=0,i=0,s=0,c=0,o=e.length,h=3===e.length&&"M"===e[0][0]&&"R"===e[1][0].toUpperCase()&&"Z"===e[2][0].toUpperCase();"M"===e[0][0]&&(n=+e[0][1],r=+e[0][2],i=n,s=r,c++,t[0]=["M",n,r]);for(var u=function(a){var c=[],o=e[a],u=o[0],l=[];if(t.push(c=[]),u!==u.toUpperCase())switch(c[0]=u.toUpperCase(),c[0]){case"A":c[1]=o[1],c[2]=o[2],c[3]=o[3],c[4]=o[4],c[5]=o[5],c[6]=+o[6]+n,c[7]=+o[7]+r;break;case"V":c[1]=+o[1]+r;break;case"H":c[1]=+o[1]+n;break;case"R":for(var p=2,f=(l=[n,r].concat(o.slice(1))).length;p<f;p++)l[p]=+l[p]+n,l[++p]=+l[p]+r;t.pop(),t=t.concat(x(l,h));break;case"O":t.pop(),(l=g(n,r,+o[1],+o[2])).push(l[0]),t=t.concat(l);break;case"U":t.pop(),t=t.concat(g(n,r,o[1],o[2],o[3])),c=["U"].concat(t[t.length-1].slice(-2));break;case"M":i=+o[1]+n,s=+o[2]+r;default:for(var v=1,d=o.length;v<d;v++)c[v]=+o[v]+(v%2?n:r)}else"R"===u?(l=[n,r].concat(o.slice(1)),t.pop(),t=t.concat(x(l,h)),c=["R"].concat(o.slice(-2))):"O"===u?(t.pop(),(l=g(n,r,+o[1],+o[2])).push(l[0]),t=t.concat(l)):"U"===u?(t.pop(),t=t.concat(g(n,r,+o[1],+o[2],+o[3])),c=["U"].concat(t[t.length-1].slice(-2))):o.map((function(e){return c.push(e)}));if("O"!==(u=u.toUpperCase()))switch(c[0]){case"Z":n=i,r=s;break;case"H":n=+c[1];break;case"V":r=+c[1];break;case"M":i=+c[c.length-2],s=+c[c.length-1];default:n=+c[c.length-2],r=+c[c.length-1]}},l=c;l<o;l++)u(l);return a(t)}function d(e){e=f(e);var t=[],n=0,r=0,i=0,s=0,c=0,o=e.length;"M"===e[0][0]&&(n=+e[0][1],r=+e[0][2],i=n,s=r,c++,t.push(["M",n,r]));for(var h=function(a){var c=void 0,o=e[a];if(t.push(c=[]),o[0]!==o[0].toLowerCase())switch(c[0]=o[0].toLowerCase(),c[0]){case"a":c[1]=o[1],c[2]=o[2],c[3]=o[3],c[4]=o[4],c[5]=o[5],c[6]=+o[6]-n,c[7]=+o[7]-r;break;case"v":c[1]=+o[1]-r;break;case"m":i=+o[1],s=+o[2];default:for(var h=1,u=o.length;h<u;h++)c[h]=+o[h]-(h%2?n:r)}else c=[],t[a]=c,"m"===o[0]&&(i=+o[1]+n,s=+o[2]+r),o.map((function(e){return t[a].push(e)}));var l=t[a].length;switch(t[a][0]){case"z":n=i,r=s;break;case"h":n+=t[a][l-1];break;case"v":r+=t[a][l-1];break;default:n+=t[a][l-2],r+=t[a][l-1]}},u=c;u<o;u++)h(u);return a(t)}function y(e){return e.map((function(e){return"string"==typeof e?e:e.shift()+e.join(" ")})).join("")}function m(t){var a,n,r,i,s,c,o=e(t),h=o.length-2,u=0,l=0,p=[],f=[],x=o.slice(1),g=x.map((function(e,t){return l=(u=h-t)-1<0?h:u-1,p=x[u],f=x[l],s=f[f.length-2],c=f[f.length-1],a=p[3],n=p[4],r=p[1],i=p[2],["C",a,n,r,i,s,c]}));return[["M",s,c]].concat(g)}function M(e,t,a){return{x:e*Math.cos(a)-t*Math.sin(a),y:e*Math.sin(a)+t*Math.cos(a)}}function b(e,t,a,n,r,i,s,c,o,h){var u,l,p,f,x,g=120*Math.PI/180,v=Math.PI/180*(r||0),d=[];if(h)l=h[0],p=h[1],f=h[2],x=h[3];else{e=(u=M(e,t,-v)).x,t=u.y;var y=(e-(c=(u=M(c,o,-v)).x))/2,m=(t-(o=u.y))/2,C=y*y/(a*a)+m*m/(n*n);C>1&&(a*=C=Math.sqrt(C),n*=C);var A=a*a,k=n*n,V=(i==s?-1:1)*Math.sqrt(Math.abs((A*k-A*m*m-k*y*y)/(A*m*m+k*y*y)));f=V*a*m/n+(e+c)/2,x=V*-n*y/a+(t+o)/2,l=Math.asin(((t-x)/n).toFixed(9)),p=Math.asin(((o-x)/n).toFixed(9)),l=e<f?Math.PI-l:l,p=c<f?Math.PI-p:p,l<0&&(l=2*Math.PI+l),p<0&&(p=2*Math.PI+p),s&&l>p&&(l-=2*Math.PI),!s&&p>l&&(p-=2*Math.PI)}var q=p-l;if(Math.abs(q)>g){var I=p,w=c,P=o;p=l+g*(s&&p>l?1:-1),c=f+a*Math.cos(p),o=x+n*Math.sin(p),d=b(c,o,a,n,r,0,s,w,P,[p,I,f,x])}q=p-l;var S=Math.cos(l),U=Math.sin(l),T=Math.cos(p),L=Math.sin(p),j=Math.tan(q/4),R=4/3*a*j,z=4/3*n*j,H=[e,t],O=[e+R*U,t-z*S],Z=[c+R*L,o-z*T],D=[c,o];return O[0]=2*H[0]-O[0],O[1]=2*H[1]-O[1],h?[O,Z,D].concat(d):(d=[O,Z,D].concat(d).join().split(",")).map((function(e,t){return t%2?M(d[t-1],e,v).y:M(e,d[t+1],v).x}))}function C(e,t,a,n,r,i){return[1/3*e+2/3*a,1/3*t+2/3*n,1/3*r+2/3*a,1/3*i+2/3*n,r,i]}function A(e,t,a,n){return[e,t,a,n,a,n]}function k(e,t,a){var n,r;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(b.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":"C"===a||"S"===a?(n=2*t.x-t.bx,r=2*t.y-t.by):(n=t.x,r=t.y),e=["C",n,r].concat(e.slice(1));break;case"T":"Q"===a||"T"===a?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(C(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(C(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(A(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(A(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(A(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(A(t.x,t.y,t.X,t.Y))}return e}function V(e,t,a,n,r,i){e&&t&&"M"===e[r][0]&&"M"!==t[r][0]&&(t.splice(r,0,["M",n.x,n.y]),a.bx=0,a.by=0,a.x=e[r][1],a.y=e[r][2],Math.max(p.length,p2&&p2.length||0))}function q(e,t,a,n,r,i){if(e[r].length>7){e[r].shift();for(var s=e[r];s.length;)a[r]="A",t&&(n[r]="A"),e.splice(r++,0,["C"].concat(s.splice(0,6)));e.splice(r,1),Math.max(e.length,t&&t.length||0)}}function I(e,t){for(var n=v(e),r=t&&v(t),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},c=[],o=[],h="",u="",l=(Math.max(n.length,r&&r.length||0),0);l<Math.max(n.length,r&&r.length||0);l++){n[l]&&(h=n[l][0]),"C"!==h&&(c[l]=h,l&&(u=c[l-1])),n[l]=k(n[l],i,u),"A"!==c[l]&&"C"===h&&(c[l]="C"),q(n,r,c,o,l),r&&(r[l]&&(h=r[l][0]),"C"!==h&&(o[l]=h,l&&(u=o[l-1])),r[l]=k(r[l],s,u),"A"!==o[l]&&"C"===h&&(o[l]="C"),q(r,n,o,c,l)),V(n,r,i,s,l),V(r,n,s,i,l);var p=n[l],f=r&&r[l],x=p.length,g=r&&f.length;i.x=+p[x-2],i.y=+p[x-1],i.bx=+p[x-4]||i.x,i.by=+p[x-3]||i.y,s.bx=r&&(+f[g-4]||s.x),s.by=r&&(+f[g-3]||s.y),s.x=r&&f[g-2],s.y=r&&f[g-1]}return r?[a(n),a(r)]:a(n)}function w(e){var t,a,n,r,i,s,c,o,h,u=v(e).some((function(e){return"Z"===e[0].toUpperCase()})),l=m(I(e)),p=[],f=[];return l.map((function(e,u){switch(s=e[e.length-2],c=e[e.length-1],a=e[1],n=e[2],r=e[3],i=e[4],f=u-1<0?l[l.length-1]:l[u-1],o=f[f.length-2],h=f[f.length-1],t=3===e.length?"M":h===c&&h===n?"H":o===s&&o===a?"V":o===a&&h===n&&s===r&&c===i?"L":e[0]){case"M":p=["M",s,c];break;case"L":p=[t,s,c];break;case"V":p=[t,c];break;case"H":p=[t,s];break;case"C":p=[t,a,n,r,i,s,c];break;default:p=[t]}return p})).concat(u?[["Z"]]:[])}function P(e){return e.replace(/(m|M)/g,"|$1").split("|").map((function(e){return e.trim()})).filter((function(e){return e}))}function S(e){var t=v(e),a=d(e);return t.map((function(e,t){return t?e.join("").length<a[t].join("").length?e:a[t]:e}))}var U=function(t){var a=f(t);return this.segments=e(a),this.pathValue=t,this};function T(e){var t,a=e.slice(1);return a.map((function(e,n){return t=a[0===n?a.length-1:n-1],r=t.slice(t.length-2).concat(e.slice(1)),i=r[0],s=r[1],c=r[2],o=r[3],h=r[4],u=r[5],l=r[6],3*(((p=r[7])-s)*(c+h)-(l-i)*(o+u)+o*(i-h)-c*(s-u)+p*(h+i/3)-l*(u+s/3))/20;var r,i,s,c,o,h,u,l,p})).reduce((function(e,t){return e+t}),0)}U.prototype.toAbsolute=function(){var t=v(this.segments);return this.segments=e(t),this},U.prototype.toRelative=function(){var t=d(this.segments);return this.segments=e(t),this},U.prototype.reverse=function(t){this.toAbsolute();var a=P(this.pathValue).length>1&&P(this.toString()),n=a&&e(a).map((function(e,a){return t?a?w(e):f(e):w(e)})),r=a?[].concat.apply([],n):w(this.segments);return this.segments=e(r),this},U.prototype.optimize=function(){var t=S(this.segments);return this.segments=e(t),this},U.prototype.toString=function(){return y(this.segments)};var L={clonePath:e,getDrawDirection:function(e){if(Array.isArray(e)&&e.slice(1).every((function(e){return"C"===e[0]})))return T(e)>=0;throw"getDrawDirection expects a curveArray"},getShapeArea:T,splitPath:P,roundPath:a,optimizePath:S,pathToAbsolute:v,pathToRelative:d,pathToCurve:I,pathToString:y,parsePathString:f,reverseCurve:m,reversePath:w,options:t};for(var j in L)U[j]=L[j];return U}));
