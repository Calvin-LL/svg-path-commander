// SVGPathCommander v0.0.1-l | thednp Â© 2020 | MIT-License
function t(e){return e.map((function(e){return Array.isArray(e)?t(e):isNaN(+e)?e:+e}))}var e={decimals:3,round:1};function a(a){return e.round?a.map((function(t){return t.map((function(t,a){var n=+t,r=Math.pow(10,e.decimals);return a?n%1==0?n:(n*r>>0)/r:t}))})):t(a)}function n(t){return this.segments=[],this.pathValue=t,this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err="",this}var r={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function s(t){var e=t.pathValue[t.segmentStart],a=e.toLowerCase(),n=t.data;if("m"===a&&n.length>2&&(t.segments.push([e,n[0],n[1]]),n=n.slice(2),a="l",e="m"===e?"l":"L"),"r"===a)t.segments.push([e].concat(n));else for(;n.length>=r[a]&&(t.segments.push([e].concat(n.splice(0,r[a]))),r[a]););}function i(t){var e=t.pathValue.charCodeAt(t.index);return 48===e?(t.param=0,void t.index++):49===e?(t.param=1,void t.index++):void(t.err="SvgPath: arc flag can be 0 or 1 only (at pos "+t.index+")")}function c(t){return t>=48&&t<=57}function o(t){var e,a=t.index,n=a,r=t.max,s=!1,i=!1,o=!1,h=!1;if(n>=r)t.err="SvgPath: missed param (at pos "+n+")";else if(43!==(e=t.pathValue.charCodeAt(n))&&45!==e||(e=++n<r?t.pathValue.charCodeAt(n):0),c(e)||46===e){if(46!==e){if(s=48===e,e=++n<r?t.pathValue.charCodeAt(n):0,s&&n<r&&e&&c(e))return void(t.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+a+")");for(;n<r&&c(t.pathValue.charCodeAt(n));)n++,i=!0;e=n<r?t.pathValue.charCodeAt(n):0}if(46===e){for(h=!0,n++;c(t.pathValue.charCodeAt(n));)n++,o=!0;e=n<r?t.pathValue.charCodeAt(n):0}if(101===e||69===e){if(h&&!i&&!o)return void(t.err="SvgPath: invalid float exponent (at pos "+n+")");if(43!==(e=++n<r?t.pathValue.charCodeAt(n):0)&&45!==e||n++,!(n<r&&c(t.pathValue.charCodeAt(n))))return void(t.err="SvgPath: invalid float exponent (at pos "+n+")");for(;n<r&&c(t.pathValue.charCodeAt(n));)n++}t.index=n,t.param=+t.pathValue.slice(a,n)}else t.err="SvgPath: param should start with 0..9 or `.` (at pos "+n+")"}function h(t){return t>=48&&t<=57||43===t||45===t||46===t}function u(t){for(;t.index<t.max&&(10===(e=t.pathValue.charCodeAt(t.index))||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0);)t.index++;var e}function l(t){var e,a,n,c,l=t.max;if(t.segmentStart=t.index,function(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}(e=t.pathValue.charCodeAt(t.index)))if(n=r[t.pathValue[t.index].toLowerCase()],t.index++,u(t),t.data=[],n){for(a=!1;;){for(c=n;c>0;c--){if(97!=(32|e)||3!==c&&4!==c?o(t):i(t),t.err.length)return;t.data.push(t.param),u(t),a=!1,t.index<l&&44===t.pathValue.charCodeAt(t.index)&&(t.index++,u(t),a=!0)}if(!a){if(t.index>=t.max)break;if(!h(t.pathValue.charCodeAt(t.index)))break}}s(t)}else s(t);else t.err="SvgPath: bad command "+t.pathValue[t.index]+" (at pos "+t.index+")"}function f(e){if(Array.isArray(e)&&Array.isArray(e[0]))return t(e);var r=new n(e),s=r.max;for(u(r);r.index<s&&!r.err.length;)l(r);return r.err.length?r.segments=[]:r.segments.length&&("mM".indexOf(r.segments[0][0])<0?(r.err="Path string should start with `M` or `m`",r.segments=[]):r.segments[0][0]="M"),a(r.segments)}function x(t,e){for(var a=[],n=0,r=t.length;r-2*!e>n;n+=2){var s=[{x:+t[n-2],y:+t[n-1]},{x:+t[n],y:+t[n+1]},{x:+t[n+2],y:+t[n+3]},{x:+t[n+4],y:+t[n+5]}];e?n?r-4==n?s[3]={x:+t[0],y:+t[1]}:r-2==n&&(s[2]={x:+t[0],y:+t[1]},s[3]={x:+t[2],y:+t[3]}):s[0]={x:+t[r-2],y:+t[r-1]}:r-4==n?s[3]=s[2]:n||(s[0]={x:+t[n],y:+t[n+1]}),a.push(["C",(-s[0].x+6*s[1].x+s[2].x)/6,(-s[0].y+6*s[1].y+s[2].y)/6,(s[1].x+6*s[2].x-s[3].x)/6,(s[1].y+6*s[2].y-s[3].y)/6,s[2].x,s[2].y])}return a}function g(t,e,a,n,r){var s;if(null==r&&null==n&&(n=a),t=+t,e=+e,a=+a,n=+n,null!=r){var i=Math.PI/180,c=t+a*Math.cos(-n*i),o=t+a*Math.cos(-r*i);s=[["M",c,e+a*Math.sin(-n*i)],["A",a,a,0,+(r-n>180),0,o,e+a*Math.sin(-r*i)]]}else s=[["M",t,e],["m",0,-n],["a",a,n,0,1,1,0,2*n],["a",a,n,0,1,1,0,-2*n],["z"]];return s}function y(t){if(!(t=f(t))||!t.length)return[["M",0,0]];var e=[],n=0,r=0,s=0,i=0,c=0,o=t.length,h=3===t.length&&"M"===t[0][0]&&"R"===t[1][0].toUpperCase()&&"Z"===t[2][0].toUpperCase();"M"===t[0][0]&&(n=+t[0][1],r=+t[0][2],s=n,i=r,c++,e[0]=["M",n,r]);for(var u=function(a){var c=[],o=t[a],u=o[0],l=[];if(e.push(c=[]),u!==u.toUpperCase())switch(c[0]=u.toUpperCase(),c[0]){case"A":c[1]=o[1],c[2]=o[2],c[3]=o[3],c[4]=o[4],c[5]=o[5],c[6]=+o[6]+n,c[7]=+o[7]+r;break;case"V":c[1]=+o[1]+r;break;case"H":c[1]=+o[1]+n;break;case"R":for(var p=2,f=(l=[n,r].concat(o.slice(1))).length;p<f;p++)l[p]=+l[p]+n,l[++p]=+l[p]+r;e.pop(),e=e.concat(x(l,h));break;case"O":e.pop(),(l=g(n,r,+o[1],+o[2])).push(l[0]),e=e.concat(l);break;case"U":e.pop(),e=e.concat(g(n,r,o[1],o[2],o[3])),c=["U"].concat(e[e.length-1].slice(-2));break;case"M":s=+o[1]+n,i=+o[2]+r;default:for(var y=1,v=o.length;y<v;y++)c[y]=+o[y]+(y%2?n:r)}else"R"===u?(l=[n,r].concat(o.slice(1)),e.pop(),e=e.concat(x(l,h)),c=["R"].concat(o.slice(-2))):"O"===u?(e.pop(),(l=g(n,r,+o[1],+o[2])).push(l[0]),e=e.concat(l)):"U"===u?(e.pop(),e=e.concat(g(n,r,+o[1],+o[2],+o[3])),c=["U"].concat(e[e.length-1].slice(-2))):o.map((function(t){return c.push(t)}));if("O"!==(u=u.toUpperCase()))switch(c[0]){case"Z":n=s,r=i;break;case"H":n=+c[1];break;case"V":r=+c[1];break;case"M":s=+c[c.length-2],i=+c[c.length-1];default:n=+c[c.length-2],r=+c[c.length-1]}},l=c;l<o;l++)u(l);return a(e)}function v(t){t=f(t);var e=[],n=0,r=0,s=0,i=0,c=0,o=t.length;"M"===t[0][0]&&(n=+t[0][1],r=+t[0][2],s=n,i=r,c++,e.push(["M",n,r]));for(var h=function(a){var c=void 0,o=t[a];if(e.push(c=[]),o[0]!==o[0].toLowerCase())switch(c[0]=o[0].toLowerCase(),c[0]){case"a":c[1]=o[1],c[2]=o[2],c[3]=o[3],c[4]=o[4],c[5]=o[5],c[6]=+o[6]-n,c[7]=+o[7]-r;break;case"v":c[1]=+o[1]-r;break;case"m":s=+o[1],i=+o[2];default:for(var h=1,u=o.length;h<u;h++)c[h]=+o[h]-(h%2?n:r)}else c=[],e[a]=c,"m"===o[0]&&(s=+o[1]+n,i=+o[2]+r),o.map((function(t){return e[a].push(t)}));var l=e[a].length;switch(e[a][0]){case"z":n=s,r=i;break;case"h":n+=e[a][l-1];break;case"v":r+=e[a][l-1];break;default:n+=e[a][l-2],r+=e[a][l-1]}},u=c;u<o;u++)h(u);return a(e)}function m(t){return t.map((function(t){return"string"==typeof t?t:t.shift()+t.join(" ")})).join("")}function d(e){var a,n,r,s,i,c,o=t(e),h=o.length-2,u=0,l=0,p=[],f=[],x=o.slice(1),g=x.map((function(t,e){return l=(u=h-e)-1<0?h:u-1,p=x[u],f=x[l],i=f[f.length-2],c=f[f.length-1],a=p[3],n=p[4],r=p[1],s=p[2],["C",a,n,r,s,i,c]}));return[["M",i,c]].concat(g)}function M(t,e,a){return{x:t*Math.cos(a)-e*Math.sin(a),y:t*Math.sin(a)+e*Math.cos(a)}}function b(t,e,a,n,r,s,i,c,o,h){var u,l,p,f,x,g=120*Math.PI/180,y=Math.PI/180*(r||0),v=[];if(h)l=h[0],p=h[1],f=h[2],x=h[3];else{t=(u=M(t,e,-y)).x,e=u.y;var m=(t-(c=(u=M(c,o,-y)).x))/2,d=(e-(o=u.y))/2,C=m*m/(a*a)+d*d/(n*n);C>1&&(a*=C=Math.sqrt(C),n*=C);var A=a*a,k=n*n,V=(s==i?-1:1)*Math.sqrt(Math.abs((A*k-A*d*d-k*m*m)/(A*d*d+k*m*m)));f=V*a*d/n+(t+c)/2,x=V*-n*m/a+(e+o)/2,l=Math.asin(((e-x)/n*1e4>>0)/1e4),p=Math.asin(((o-x)/n*1e4>>0)/1e4),l=t<f?Math.PI-l:l,p=c<f?Math.PI-p:p,l<0&&(l=2*Math.PI+l),p<0&&(p=2*Math.PI+p),i&&l>p&&(l-=2*Math.PI),!i&&p>l&&(p-=2*Math.PI)}var P=p-l;if(Math.abs(P)>g){var q=p,w=c,S=o;p=l+g*(i&&p>l?1:-1),c=f+a*Math.cos(p),o=x+n*Math.sin(p),v=b(c,o,a,n,r,0,i,w,S,[p,q,f,x])}P=p-l;var U=Math.cos(l),I=Math.sin(l),L=Math.cos(p),T=Math.sin(p),R=Math.tan(P/4),j=4/3*a*R,z=4/3*n*R,H=[t,e],O=[t+j*I,e-z*U],Z=[c+j*T,o-z*L],D=[c,o];return O[0]=2*H[0]-O[0],O[1]=2*H[1]-O[1],h?[O,Z,D].concat(v):(v=[O,Z,D].concat(v).join().split(",")).map((function(t,e){return e%2?M(v[e-1],t,y).y:M(t,v[e+1],y).x}))}function C(t,e,a,n,r,s){return[1/3*t+2/3*a,1/3*e+2/3*n,1/3*r+2/3*a,1/3*s+2/3*n,r,s]}function A(t,e,a,n){return[t,e,a,n,a,n]}function k(t,e,a){var n,r;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"].concat(b.apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":"C"===a||"S"===a?(n=2*e.x-e.bx,r=2*e.y-e.by):(n=e.x,r=e.y),t=["C",n,r].concat(t.slice(1));break;case"T":"Q"===a||"T"===a?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(C(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(C(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"].concat(A(e.x,e.y,t[1],t[2]));break;case"H":t=["C"].concat(A(e.x,e.y,t[1],e.y));break;case"V":t=["C"].concat(A(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"].concat(A(e.x,e.y,e.X,e.Y))}return t}function V(t,e,a,n,r,s){t&&e&&"M"===t[r][0]&&"M"!==e[r][0]&&(e.splice(r,0,["M",n.x,n.y]),a.bx=0,a.by=0,a.x=t[r][1],a.y=t[r][2],Math.max(p.length,p2&&p2.length||0))}function P(t,e,a,n,r,s){if(t[r].length>7){t[r].shift();for(var i=t[r];i.length;)a[r]="A",e&&(n[r]="A"),t.splice(r++,0,["C"].concat(i.splice(0,6)));t.splice(r,1),Math.max(t.length,e&&e.length||0)}}function q(t,e){for(var n=y(t),r=e&&y(e),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},c=[],o=[],h="",u="",l=(Math.max(n.length,r&&r.length||0),0);l<Math.max(n.length,r&&r.length||0);l++){n[l]&&(h=n[l][0]),"C"!==h&&(c[l]=h,l&&(u=c[l-1])),n[l]=k(n[l],s,u),"A"!==c[l]&&"C"===h&&(c[l]="C"),P(n,r,c,o,l),r&&(r[l]&&(h=r[l][0]),"C"!==h&&(o[l]=h,l&&(u=o[l-1])),r[l]=k(r[l],i,u),"A"!==o[l]&&"C"===h&&(o[l]="C"),P(r,n,o,c,l)),V(n,r,s,i,l),V(r,n,i,s,l);var p=n[l],f=r&&r[l],x=p.length,g=r&&f.length;s.x=+p[x-2],s.y=+p[x-1],s.bx=+p[x-4]||s.x,s.by=+p[x-3]||s.y,i.bx=r&&(+f[g-4]||i.x),i.by=r&&(+f[g-3]||i.y),i.x=r&&f[g-2],i.y=r&&f[g-1]}return r?[a(n),a(r)]:a(n)}function w(t){var e,a,n,r,s,i,c,o,h,u=y(t).some((function(t){return"Z"===t[0].toUpperCase()})),l=d(q(t)),p=[],f=[];return l.map((function(t,u){switch(i=t[t.length-2],c=t[t.length-1],a=t[1],n=t[2],r=t[3],s=t[4],f=u-1<0?l[l.length-1]:l[u-1],o=f[f.length-2],h=f[f.length-1],e=3===t.length?"M":h===c&&h===n?"H":o===i&&o===a?"V":o===a&&h===n&&i===r&&c===s?"L":t[0]){case"M":p=["M",i,c];break;case"L":p=[e,i,c];break;case"V":p=[e,c];break;case"H":p=[e,i];break;case"C":p=[e,a,n,r,s,i,c];break;default:p=[e]}return p})).concat(u?[["Z"]]:[])}function S(t){return t.replace(/(m|M)/g,"|$1").split("|").map((function(t){return t.trim()})).filter((function(t){return t}))}function U(t){var e=y(t),a=v(t);return e.map((function(t,e){return e?t.join("").length<a[e].join("").length?t:a[e]:t}))}var I=function(e){var a=f(e);return this.segments=t(a),this.pathValue=e,this};function L(t){var e,a=t.slice(1);return a.map((function(t,n){return e=a[0===n?a.length-1:n-1],r=e.slice(e.length-2).concat(t.slice(1)),s=r[0],i=r[1],c=r[2],o=r[3],h=r[4],u=r[5],l=r[6],3*(((p=r[7])-i)*(c+h)-(l-s)*(o+u)+o*(s-h)-c*(i-u)+p*(h+s/3)-l*(u+i/3))/20;var r,s,i,c,o,h,u,l,p})).reduce((function(t,e){return t+e}),0)}I.prototype.toAbsolute=function(){var e=y(this.segments);return this.segments=t(e),this},I.prototype.toRelative=function(){var e=v(this.segments);return this.segments=t(e),this},I.prototype.reverse=function(e){this.toAbsolute();var a=S(this.pathValue).length>1&&S(this.toString()),n=a&&t(a).map((function(t,a){return e?a?w(t):f(t):w(t)})),r=a?[].concat.apply([],n):w(this.segments);return this.segments=t(r),this},I.prototype.optimize=function(){var e=U(this.segments);return this.segments=t(e),this},I.prototype.toString=function(){return m(this.segments)};var T={clonePath:t,getDrawDirection:function(t){if(Array.isArray(t)&&t.slice(1).every((function(t){return"C"===t[0]})))return L(t)>=0;throw"getDrawDirection expects a curveArray"},getShapeArea:L,splitPath:S,roundPath:a,optimizePath:U,pathToAbsolute:y,pathToRelative:v,pathToCurve:q,pathToString:m,parsePathString:f,reverseCurve:d,reversePath:w,options:e};for(var R in T)I[R]=T[R];export default I;
