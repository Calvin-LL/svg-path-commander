// SVGPathCommander v0.1.11alpha3 | thednp Â© 2021 | MIT-License
const t={origin:[0,0],decimals:4,round:1},e={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function r(t){let r=t.pathValue[t.segmentStart],n=r.toLowerCase(),{data:s}=t;for("m"===n&&s.length>2&&(t.segments.push([r,s[0],s[1]]),s=s.slice(2),n="l",r="m"===r?"l":"L");s.length>=e[n]&&(t.segments.push([r,...s.splice(0,e[n])]),e[n]););}function n(t){const{index:e}=t,r=t.pathValue.charCodeAt(e);return 48===r?(t.param=0,void(t.index+=1)):49===r?(t.param=1,void(t.index+=1)):void(t.err=`Invalid path value: invalid Arc flag ${r}, expecting 0 or 1 at index ${e}`)}function s(t){return t>=48&&t<=57}function a(t){const{max:e,pathValue:r,index:n}=t;let a,i=n,m=!1,o=!1,c=!1,l=!1;if(i>=e)t.err=`Invalid path value at ${i}: missing param ${r[i]}`;else if(a=r.charCodeAt(i),43!==a&&45!==a||(i+=1,a=i<e?r.charCodeAt(i):0),s(a)||46===a){if(46!==a){if(m=48===a,i+=1,a=i<e?r.charCodeAt(i):0,m&&i<e&&a&&s(a))return void(t.err=`Invalid path value at index ${n}: ${r[n]} illegal number`);for(;i<e&&s(r.charCodeAt(i));)i+=1,o=!0;a=i<e?r.charCodeAt(i):0}if(46===a){for(l=!0,i+=1;s(r.charCodeAt(i));)i+=1,c=!0;a=i<e?r.charCodeAt(i):0}if(101===a||69===a){if(l&&!o&&!c)return void(t.err=`Invalid path value at index ${i}: ${r[i]} invalid float exponent`);if(i+=1,a=i<e?r.charCodeAt(i):0,43!==a&&45!==a||(i+=1),!(i<e&&s(r.charCodeAt(i))))return void(t.err=`Invalid path value at index ${i}: ${r[i]} invalid float exponent`);for(;i<e&&s(r.charCodeAt(i));)i+=1}t.index=i,t.param=+t.pathValue.slice(n,i)}else t.err=`Invalid path value at index ${i}: ${r[i]} is not a number`}function i(t){const{pathValue:e,max:r}=t;for(;t.index<r&&(10===(n=e.charCodeAt(t.index))||13===n||8232===n||8233===n||32===n||9===n||11===n||12===n||160===n||n>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(n)>=0);)t.index+=1;var n}function m(t){return t>=48&&t<=57||43===t||45===t||46===t}function o(t){const{max:s,pathValue:o,index:c}=t,l=o.charCodeAt(c),u=e[o[c].toLowerCase()];if(t.segmentStart=c,function(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}(l))if(t.index+=1,i(t),t.data=[],u){for(;;){for(let e=u;e>0;e-=1){if(97!=(32|l)||3!==e&&4!==e?a(t):n(t),t.err.length)return;t.data.push(t.param),i(t),t.index<s&&44===o.charCodeAt(t.index)&&(t.index+=1,i(t))}if(t.index>=t.max)break;if(!m(o.charCodeAt(t.index)))break}r(t)}else r(t);else t.err=`Invalid path value: ${o[c]} not a path command`}function c(t){return Array.isArray(t)?t.map(t=>Array.isArray(t)?c(t):Number.isNaN(+t)?t:+t):t}function l(t){this.segments=[],this.pathValue=t,this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}function u(t){return Array.isArray(t)&&t.every(t=>{const r=t[0].toLowerCase();return e[r]===t.length-1&&/[achlmqstvz]/gi.test(r)})}function h(t){if(u(t))return c(t);const e=new l(""+t);for(i(e);e.index<e.max&&!e.err.length;)o(e);return e.err.length?e.segments=[]:e.segments.length&&("mM".includes(e.segments[0][0])?e.segments[0][0]="M":(e.err="Invalid path value: missing M/m",e.segments=[])),e.segments}function f(t){return Array.isArray(t)&&u(t)&&t.every(t=>t[0]===t[0].toUpperCase())}function y(t){if(f(t))return c(t);const e=h(t),r=e.length,n=[];let s=0,a=0,i=0,m=0,o=0;"M"===e[0][0]&&([s,a]=e[0].slice(1).map(Number),i=s,m=a,o+=1,n.push(["M",s,a]));for(let t=o;t<r;t+=1){const r=e[t],[o]=r,c=o.toUpperCase(),l=[];let u=[];if(n.push(l),o!==c)switch(l[0]=c,c){case"A":u=[...r.slice(1,-2).map(Number),r[6]+s,r[7]+a];for(let t=0;t<u.length;t+=1)l.push(u[t]);break;case"V":l[1]=r[1]+a;break;case"H":l[1]=r[1]+s;break;default:"M"===c&&(i=r[1]+s,m=r[2]+a);for(let t=1;t<r.length;t+=1)l.push(+r[t]+(t%2?s:a))}else for(let t=0;t<r.length;t+=1)l.push(r[t]);const h=l.length;switch(c){case"Z":s=i,a=m;break;case"H":s=+l[1];break;case"V":a=+l[1];break;default:s=+l[h-2],a=+l[h-1],"M"===c&&(i=s,m=a)}}return n}function x(t){return Array.isArray(t)&&u(t)&&t.slice(1).every(t=>t[0]===t[0].toLowerCase())}function p(t){if(x(t))return c(t);const e=h(t),r=e.length,n=[];let s=0,a=0,i=0,m=0,o=0;"M"===e[0][0]&&(s=+e[0][1],a=+e[0][2],i=s,m=a,o+=1,n.push(["M",s,a]));for(let t=o;t<r;t+=1){const r=e[t],[o]=r,c=o.toLowerCase(),l=[];let u=[];if(n.push(l),o!==c)switch(l[0]=c,c){case"a":u=[...r.slice(1,-2).map(Number),r[6]-s,r[7]-a];for(let t=0;t<u.length;t+=1)l.push(u[t]);break;case"v":l[1]=+r[1]-a;break;default:for(let t=1;t<r.length;t+=1)l.push(+r[t]-(t%2?s:a));"m"===c&&(i=+r[1],m=+r[2])}else{"m"===o&&(i=+r[1]+s,m=+r[2]+a);for(let t=0;t<r.length;t+=1)l.push(r[t])}const h=l.length;switch(l[0]){case"z":s=i,a=m;break;case"h":s+=+l[h-1];break;case"v":a+=+l[h-1];break;default:s+=+n[t][h-2],a+=+n[t][h-1]}}return n}function d(e,r){const{round:n,decimals:s}=t,a=r&&!Number.isNaN(+r)?+r:n&&s;if(!1===r||!n&&!a)return c(e);const i=10**a,m=[],o=e.length;let l,u=0,h=[];for(let t=0;t<o;t+=1){h=e[t],l=[""];for(let t=0;t<h.length;t+=1)t?(u=+h[t],l.push(t&&u%1!=0?Math.round(u*i)/i:u)):l[t]=h[t];m.push(l)}return m}function g(t,e){return d(t,e).map(t=>t[0]+t.slice(1).join(" ")).join("")}function M(t,e,r){const{x1:n,y1:s,x2:a,y2:i}=e,[m]=t,o=t.slice(1).map(Number),[c,l]=o;let u=t;if("TQ".includes(t[0])||(e.qx=null,e.qy=null),"H"===m)u=["L",t[1],s];else if("V"===m)u=["L",n,t[1]];else if("S"===m){const{x1:t,y1:m}=function(t,e,r,n,s){return"CS".includes(s)?{x1:2*t-r,y1:2*e-n}:{x1:t,y1:e}}(n,s,a,i,r);e.x1=t,e.y1=m,u=["C",t,m,...o]}else if("T"===m){const{qx:t,qy:a}=function(t,e,r,n,s){return"QT".includes(s)?{qx:2*t-r,qy:2*e-n}:{qx:t,qy:e}}(n,s,e.qx,e.qy,r);e.qx=t,e.qy=a,u=["Q",t,a,...o]}else"Q"===m&&(e.qx=c,e.qy=l);return u}function b(t){return Array.isArray(t)&&u(t)&&t.every(t=>{const r=t[0].toLowerCase();return e[r]===t.length-1&&"ACLMQZ".includes(t[0])})}function v(t){if(b(t))return c(t);const e=y(t),r={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},n=[],s=e.length;let a,i,m="",o="";for(let t=0;t<s;t+=1)[m]=e[t],n[t]=m,t&&(o=n[t-1]),e[t]=M(e[t],r,o),a=e[t],i=a.length,r.x1=+a[i-2],r.y1=+a[i-1],r.x2=+a[i-4]||r.x1,r.y2=+a[i-3]||r.y1;return e}function N(t){const e=y(t),r="Z"===e.slice(-1)[0][0];let n=[];return n=v(e).map((t,r)=>{const n=t.slice(1).map(Number),[s,a]=n.slice(-2);return{seg:e[r],n:t,c:e[r][0],values:n,x:s,y:a}}).map((t,e,n)=>{const s=t.seg,{values:a}=t,i=t.n,m=e&&n[e-1],o=n[e+1]&&n[e+1],c=t.c,l=n.length,u=e?n[e-1].x:n[l-1].x,h=e?n[e-1].y:n[l-1].y;let f=[""];switch(c){case"M":f=r?["Z"]:[c,u,h];break;case"A":f=[c,...a.slice(0,-3),1===s[5]?0:1,u,h];break;case"C":f=o&&"S"===o.c?["S",s[1],s[2],u,h]:[c,s[3],s[4],s[1],s[2],u,h];break;case"S":f=m&&"CS".includes(m.c)&&(!o||o&&"S"!==o.c)?["C",i[3],i[4],i[1],i[2],u,h]:[c,i[1],i[2],u,h];break;case"Q":f=o&&"T"===o.c?["T",u,h]:[c,...a.slice(0,-2),u,h];break;case"T":f=m&&"QT".includes(m.c)&&(!o||o&&"T"!==o.c)?["Q",i[1],i[2],u,h]:[c,u,h];break;case"Z":f=["M",u,h];break;case"H":f=[c,u];break;case"V":f=[c,h];break;default:f=[c,...a.slice(0,-2),u,h]}return f}),r?n.reverse():[n[0],...n.slice(1).reverse()]}function A(t){return g(y(t),0).replace(/(m|M)/g,"|$1").split("|").map(t=>t.trim()).filter(t=>t)}function w(t,e,r){const[n]=t,s=t.slice(1),{x1:a,y1:i,x2:m,y2:o}=e;let c=t.slice();const[l,u]=t.slice(-2);if("TQ".includes(t[0])||(e.qx=null,e.qy=null),"L"===n)a===t[1]?c=["V",t[1]]:i===t[2]&&(c=["H",t[2]]),e.x=+l,e.y=+u;else if("C"===n){const[t,n]=s.slice(-4),[h,f]=s;["C","S"].includes(r)&&h===2*a-m&&f===2*i-o&&(c=["S",t,n,l,u]),e.x1=h,e.y1=f}else if("Q"===n){const[t,n]=s;["Q","T"].includes(r)&&t===2*a-m&&n===2*i-o&&(c=["T",l,u]),e.qx=t,e.qy=n}return c}function C(t,e){const r=y(t),n={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},s=[],a=r.length;let i,m,o="",c="";for(let t=0;t<a;t+=1)[o]=r[t],s[t]=o,t&&(c=s[t-1]),r[t]=w(r[t],n,c),i=r[t],m=i.length,n.x1=+i[m-2],n.y1=+i[m-1],n.x2=+i[m-4]||n.x1,n.y2=+i[m-3]||n.y1;const l=d(y(r),e),u=d(p(r),e);return l.map((t,e)=>e?t.join("").length<u[e].join("").length?t:u[e]:t)}function q(t,e,r){return{x:t*Math.cos(r)-e*Math.sin(r),y:t*Math.sin(r)+e*Math.cos(r)}}function k(t,e,r,n,s,a,i,m,o,c){let l=t,u=e,h=r,f=n,y=m,x=o;const p=120*Math.PI/180,d=Math.PI/180*(+s||0);let g,M,b,v,N,A=[];if(c)[M,b,v,N]=c;else{g=q(l,u,-d),l=g.x,u=g.y,g=q(y,x,-d),y=g.x,x=g.y;const t=(l-y)/2,e=(u-x)/2;let r=t*t/(h*h)+e*e/(f*f);r>1&&(r=Math.sqrt(r),h*=r,f*=r);const n=h*h,s=f*f,m=(a===i?-1:1)*Math.sqrt(Math.abs((n*s-n*e*e-s*t*t)/(n*e*e+s*t*t)));v=m*h*e/f+(l+y)/2,N=m*-f*t/h+(u+x)/2,M=(Math.asin((u-N)/f)*10**9>>0)/10**9,b=(Math.asin((x-N)/f)*10**9>>0)/10**9,M=l<v?Math.PI-M:M,b=y<v?Math.PI-b:b,M<0&&(M=2*Math.PI+M),b<0&&(b=2*Math.PI+b),i&&M>b&&(M-=2*Math.PI),!i&&b>M&&(b-=2*Math.PI)}let w=b-M;if(Math.abs(w)>p){const t=b,e=y,r=x;b=M+p*(i&&b>M?1:-1),y=v+h*Math.cos(b),x=N+f*Math.sin(b),A=k(y,x,h,f,s,0,i,e,r,[b,t,v,N])}w=b-M;const C=Math.cos(M),S=Math.sin(M),P=Math.cos(b),I=Math.sin(b),T=Math.tan(w/4),V=4/3*h*T,$=4/3*f*T,L=[l,u],z=[l+V*S,u-$*C],E=[y+V*I,x-$*P],j=[y,x];if(z[0]=2*L[0]-z[0],z[1]=2*L[1]-z[1],c)return[...z,...E,...j,...A];A=[...z,...E,...j,...A];const O=[];for(let t=0,e=A.length;t<e;t+=1)O[t]=t%2?q(A[t-1],A[t],d).y:q(A[t],A[t+1],d).x;return O}function S(t,e,r,n,s,a){return[1/3*t+2/3*r,1/3*e+2/3*n,1/3*s+2/3*r,1/3*a+2/3*n,s,a]}function P(t,e,r,n,s,a,i,m,o){const c=1-o;return{x:c**3*t+c*c*3*o*r+3*c*o*o*s+o**3*i,y:c**3*e+c*c*3*o*n+3*c*o*o*a+o**3*m}}function I(t,e,r){const[n,s]=t,[a,i]=e;return[n+(a-n)*r,s+(i-s)*r]}function T(t,e,r,n){const s=.5,a=[t,e],i=[r,n],m=I(a,i,s),o=I(i,m,s),c=I(m,o,s),l=I(o,c,s),u=I(c,l,s),h=P(...[...a,...m,...c,...u,s]),f=P(...[...u,...l,...o,...i,0]);return[h.x,h.y,f.x,f.y,r,n]}function V(t,e){"TQ".includes(t[0])||(e.qx=null,e.qy=null);const r=t.slice(1).map(Number),[n,s]=r,{x1:a,y1:i,x:m,y:o}=e;switch(t[0]){case"M":return e.x=n,e.y=s,t;case"A":return["C",...k(a,i,...r)];case"Q":return e.qx=n,e.qy=s,["C",...S(a,i,...r)];case"L":return["C",...T(a,i,n,s)];case"Z":return["C",...T(a,i,m,o)]}return t}function $(t,e,r){if(t[r].length>7){t[r].shift();const n=t[r];let s=r;for(;n.length;)e[r]="A",t.splice(s+=1,0,["C",...n.splice(0,6).map(Number)]);t.splice(r,1)}}function L(t){const e=new H,r=Array.from(t);if(!r.every(t=>!Number.isNaN(t)))throw TypeError(`CSSMatrix: "${t}" must only have numbers.`);if(16===r.length){const[t,n,s,a,i,m,o,c,l,u,h,f,y,x,p,d]=r;e.m11=t,e.a=t,e.m21=i,e.c=i,e.m31=l,e.m41=y,e.e=y,e.m12=n,e.b=n,e.m22=m,e.d=m,e.m32=u,e.m42=x,e.f=x,e.m13=s,e.m23=o,e.m33=h,e.m43=p,e.m14=a,e.m24=c,e.m34=f,e.m44=d}else{if(6!==r.length)throw new TypeError("CSSMatrix: expecting an Array of 6/16 values.");{const[t,n,s,a,i,m]=r;e.m11=t,e.a=t,e.m12=n,e.b=n,e.m21=s,e.c=s,e.m22=a,e.d=a,e.m41=i,e.e=i,e.m42=m,e.f=m}}return e}function z(t){const e=Object.keys(new H);if("object"==typeof t&&e.every(e=>e in t))return L([t.m11,t.m12,t.m13,t.m14,t.m21,t.m22,t.m23,t.m24,t.m31,t.m32,t.m33,t.m34,t.m41,t.m42,t.m43,t.m44]);throw TypeError(`CSSMatrix: "${t}" is not a DOMMatrix / CSSMatrix / JSON compatible object.`)}function E(t){if("string"!=typeof t)throw TypeError(`CSSMatrix: "${t}" is not a string.`);const e=String(t).replace(/\s/g,"");let r=new H;const n=`CSSMatrix: invalid transform string "${t}"`;return e.split(")").filter(t=>t).forEach(t=>{const[e,s]=t.split("(");if(!s)throw TypeError(n);const a=s.split(",").map(t=>t.includes("rad")?parseFloat(t)*(180/Math.PI):parseFloat(t)),[i,m,o,c]=a,l=[i,m,o],u=[i,m,o,c];if("perspective"===e&&i&&[m,o].every(t=>void 0===t))r.m34=-1/i;else if(e.includes("matrix")&&[6,16].includes(a.length)&&a.every(t=>!Number.isNaN(+t))){const t=a.map(t=>Math.abs(t)<1e-6?0:t);r=r.multiply(L(t))}else if("translate3d"===e&&l.every(t=>!Number.isNaN(+t)))r=r.translate(i,m,o);else if("translate"===e&&i&&void 0===o)r=r.translate(i,m||0,0);else if("rotate3d"===e&&u.every(t=>!Number.isNaN(+t))&&c)r=r.rotateAxisAngle(i,m,o,c);else if("rotate"===e&&i&&[m,o].every(t=>void 0===t))r=r.rotate(0,0,i);else if("scale3d"===e&&l.every(t=>!Number.isNaN(+t))&&l.some(t=>1!==t))r=r.scale(i,m,o);else if("scale"!==e||Number.isNaN(i)||1===i||void 0!==o)if("skew"===e&&i&&void 0===o)r=r.skewX(i),r=m?r.skewY(m):r;else{if(!(/[XYZ]/.test(e)&&i&&[m,o].every(t=>void 0===t)&&["translate","rotate","scale","skew"].some(t=>e.includes(t))))throw TypeError(n);if(["skewX","skewY"].includes(e))r=r[e](i);else{const t=e.replace(/[XYZ]/,""),n=e.replace(t,""),s=["X","Y","Z"].indexOf(n),a=[0===s?i:0,1===s?i:0,2===s?i:0];r=r[t](...a)}}else{const t=Number.isNaN(+m)?i:m;r=r.scale(i,t,1)}}),r}function j(t,e,r){const n=new H;return n.m41=t,n.e=t,n.m42=e,n.f=e,n.m43=r,n}function O(t,e,r){const n=new H,s=Math.PI/180,a=t*s,i=e*s,m=r*s,o=Math.cos(a),c=-Math.sin(a),l=Math.cos(i),u=-Math.sin(i),h=Math.cos(m),f=-Math.sin(m),y=l*h,x=-l*f;n.m11=y,n.a=y,n.m12=x,n.b=x,n.m13=u;const p=c*u*h+o*f;n.m21=p,n.c=p;const d=o*h-c*u*f;return n.m22=d,n.d=d,n.m23=-c*l,n.m31=c*f-o*u*h,n.m32=c*h+o*u*f,n.m33=o*l,n}function Q(t,e,r,n){const s=new H,a=n*(Math.PI/360),i=Math.sin(a),m=Math.cos(a),o=i*i,c=Math.sqrt(t*t+e*e+r*r);let l=t,u=e,h=r;0===c?(l=0,u=0,h=1):(l/=c,u/=c,h/=c);const f=l*l,y=u*u,x=h*h,p=1-2*(y+x)*o;s.m11=p,s.a=p;const d=2*(l*u*o+h*i*m);s.m12=d,s.b=d,s.m13=2*(l*h*o-u*i*m);const g=2*(u*l*o-h*i*m);s.m21=g,s.c=g;const M=1-2*(x+f)*o;return s.m22=M,s.d=M,s.m23=2*(u*h*o+l*i*m),s.m31=2*(h*l*o+u*i*m),s.m32=2*(h*u*o-l*i*m),s.m33=1-2*(f+y)*o,s}function Z(t,e,r){const n=new H;return n.m11=t,n.a=t,n.m22=e,n.d=e,n.m33=r,n}function D(t){const e=new H,r=t*Math.PI/180,n=Math.tan(r);return e.m21=n,e.c=n,e}function X(t){const e=new H,r=t*Math.PI/180,n=Math.tan(r);return e.m12=n,e.b=n,e}function Y(t,e){return L([e.m11*t.m11+e.m12*t.m21+e.m13*t.m31+e.m14*t.m41,e.m11*t.m12+e.m12*t.m22+e.m13*t.m32+e.m14*t.m42,e.m11*t.m13+e.m12*t.m23+e.m13*t.m33+e.m14*t.m43,e.m11*t.m14+e.m12*t.m24+e.m13*t.m34+e.m14*t.m44,e.m21*t.m11+e.m22*t.m21+e.m23*t.m31+e.m24*t.m41,e.m21*t.m12+e.m22*t.m22+e.m23*t.m32+e.m24*t.m42,e.m21*t.m13+e.m22*t.m23+e.m23*t.m33+e.m24*t.m43,e.m21*t.m14+e.m22*t.m24+e.m23*t.m34+e.m24*t.m44,e.m31*t.m11+e.m32*t.m21+e.m33*t.m31+e.m34*t.m41,e.m31*t.m12+e.m32*t.m22+e.m33*t.m32+e.m34*t.m42,e.m31*t.m13+e.m32*t.m23+e.m33*t.m33+e.m34*t.m43,e.m31*t.m14+e.m32*t.m24+e.m33*t.m34+e.m34*t.m44,e.m41*t.m11+e.m42*t.m21+e.m43*t.m31+e.m44*t.m41,e.m41*t.m12+e.m42*t.m22+e.m43*t.m32+e.m44*t.m42,e.m41*t.m13+e.m42*t.m23+e.m43*t.m33+e.m44*t.m43,e.m41*t.m14+e.m42*t.m24+e.m43*t.m34+e.m44*t.m44])}class H{constructor(...t){const e=this;if(e.a=1,e.b=0,e.c=0,e.d=1,e.e=0,e.f=0,e.m11=1,e.m12=0,e.m13=0,e.m14=0,e.m21=0,e.m22=1,e.m23=0,e.m24=0,e.m31=0,e.m32=0,e.m33=1,e.m34=0,e.m41=0,e.m42=0,e.m43=0,e.m44=1,t&&t.length){const r=[16,6].some(e=>e===t.length)?t:t[0];return e.setMatrixValue(r)}return e}set isIdentity(t){this.isIdentity=t}get isIdentity(){const t=this;return 1===t.m11&&0===t.m12&&0===t.m13&&0===t.m14&&0===t.m21&&1===t.m22&&0===t.m23&&0===t.m24&&0===t.m31&&0===t.m32&&1===t.m33&&0===t.m34&&0===t.m41&&0===t.m42&&0===t.m43&&1===t.m44}get is2D(){const t=this;return 0===t.m31&&0===t.m32&&1===t.m33&&0===t.m34&&0===t.m43&&1===t.m44}set is2D(t){this.is2D=t}setMatrixValue(t){return[Array,Float64Array,Float32Array].some(e=>t instanceof e)?L(t):"string"==typeof t&&t.length&&"none"!==t?E(t):"object"==typeof t?z(t):this}toArray(){const t=this;let e;return e=t.is2D?[t.a,t.b,t.c,t.d,t.e,t.f]:[t.m11,t.m12,t.m13,t.m14,t.m21,t.m22,t.m23,t.m24,t.m31,t.m32,t.m33,t.m34,t.m41,t.m42,t.m43,t.m44],e.map(t=>Math.abs(t)<1e-6?0:(t*10**6>>0)/10**6)}toString(){const t=this.toArray();return`${this.is2D?"matrix":"matrix3d"}(${t})`}toJSON(){const{is2D:t,isIdentity:e}=this;return{...this,is2D:t,isIdentity:e}}multiply(t){return Y(this,t)}translate(t,e,r){let n=e,s=r;return void 0===s&&(s=0),void 0===n&&(n=0),Y(this,j(t,n,s))}scale(t,e,r){let n=e,s=r;return void 0===n&&(n=t),void 0===s&&(s=1),Y(this,Z(t,n,s))}rotate(t,e,r){let n=t,s=e,a=r;return void 0===s&&(s=0),void 0===a&&(a=n,n=0),Y(this,O(n,s,a))}rotateAxisAngle(t,e,r,n){if([t,e,r,n].some(t=>Number.isNaN(t)))throw new TypeError("CSSMatrix: expecting 4 values");return Y(this,Q(t,e,r,n))}skewX(t){return Y(this,D(t))}skewY(t){return Y(this,X(t))}transformPoint(t){let e=j(t.x,t.y,t.z);return e.m44=t.w||1,e=this.multiply(e),{x:e.m41,y:e.m42,z:e.m43,w:e.m44}}transform(t){const e=this,r=e.m11*t.x+e.m12*t.y+e.m13*t.z+e.m14*t.w,n=e.m21*t.x+e.m22*t.y+e.m23*t.z+e.m24*t.w,s=e.m31*t.x+e.m32*t.y+e.m33*t.z+e.m34*t.w,a=e.m41*t.x+e.m42*t.y+e.m43*t.z+e.m44*t.w;return{x:r/a,y:n/a,z:s/a,w:a}}}function R(t){let e=new H;const{origin:r}=t,[n,s]=r,{translate:a}=t,{rotate:i}=t,{skew:m}=t,{scale:o}=t;return(i||m||o)&&(e=e.translate(n,s),Array.isArray(i)&&i.every(t=>!Number.isNaN(+t))&&i.some(t=>0!==t)?e=e.rotate(i[0],i[1],i[2]):Number.isNaN(+i)||(e=e.rotate(0,0,i)),Array.isArray(m)&&m.every(t=>!Number.isNaN(+t))&&m.some(t=>0!==t)?(e=m[0]?e.skewX(m[0]):e,e=m[1]?e.skewY(m[1]):e):Number.isNaN(+m)||(e=e.skewX(m||0)),Array.isArray(o)&&o.every(t=>!Number.isNaN(+t))&&o.some(t=>1!==t)?e=e.scale(o[0],o[1],o[2]):Number.isNaN(+o)||(e=e.scale(o||1,o||1,o||1)),e=e.translate(-n,-s)),Array.isArray(a)&&a.every(t=>!Number.isNaN(+t))&&a.some(t=>0!==t)?e=e.translate(a[0]||0,a[1]||0,a[2]||0):Number.isNaN(+a)||(e=e.translate(a||0,0,0)),e}function F(t,e,r){const[n,s,a]=r,i=t.transformPoint({x:e[0],y:e[1],z:0,w:1}),m=i.x-n,o=i.y-s,c=i.z-a;return[m*(Math.abs(a)/Math.abs(c))+n,o*(Math.abs(a)/Math.abs(c))+s]}function B(t,e){let r,n,s,a,i,m,o,l=0,u=0;const h=y(t),f=v(h),x=R(e),p=Object.keys(e),{origin:d}=e,{a:g,b:M,c:b,d:N,e:A,f:w}=x,C=[g,M,b,N,A,w],q={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};let k=[""],S=0,P="",I=[];const T=[];if(!x.isIdentity){for(r=0,s=h.length;r<s;r+=1){k=h[r],h[r]&&([P]=k),T[r]=P,"A"!==P||x.is2D&&["skewX","skewY"].find(t=>p.includes(t))||(k=V(f[r],q),h[r]=V(f[r],q),$(h,T,r),f[r]=V(f[r],q),$(f,T,r),s=Math.max(h.length,f.length)),k=f[r],S=k.length,q.x1=+k[S-2],q.y1=+k[S-1],q.x2=+k[S-4]||q.x1,q.y2=+k[S-3]||q.y1;const t={s:h[r],c:h[r][0],x:q.x1,y:q.y1};I=[...I,t]}return I.map(t=>{switch(P=t.c,k=t.s,P){case"A":return o=function(t,e,r,n){const s=Math.cos(n*Math.PI/180),a=Math.sin(n*Math.PI/180),i=[e*(t[0]*s+t[2]*a),e*(t[1]*s+t[3]*a),r*(-t[0]*a+t[2]*s),r*(-t[1]*a+t[3]*s)],m=i[0]*i[0]+i[2]*i[2],o=i[1]*i[1]+i[3]*i[3];let c=((i[0]-i[3])*(i[0]-i[3])+(i[2]+i[1])*(i[2]+i[1]))*((i[0]+i[3])*(i[0]+i[3])+(i[2]-i[1])*(i[2]-i[1]));const l=(m+o)/2;if(c<1e-9*l){const t=Math.sqrt(l);return{rx:t,ry:t,ax:0}}const u=i[0]*i[1]+i[2]*i[3];c=Math.sqrt(c);const h=l+c/2,f=l-c/2;let y,x,p=Math.abs(u)<1e-9&&Math.abs(h-o)<1e-9?90:Math.atan(Math.abs(u)>Math.abs(h-o)?(h-m)/u:u/(h-o)*180)/Math.PI;return p>=0?(y=Math.sqrt(h),x=Math.sqrt(f)):(p+=90,y=Math.sqrt(f),x=Math.sqrt(h)),{rx:y,ry:x,ax:p}}(C,+k[1],+k[2],+k[3]),C[0]*C[3]-C[1]*C[2]<0&&(k[5]=+k[5]?0:1),[i,m]=F(x,[+k[6],+k[7]],d),k=l===i&&u===m||o.rx<1e-9*o.ry||o.ry<1e-9*o.rx?["L",i,m]:[P,o.rx,o.ry,o.ax,k[4],k[5],i,m],l=i,u=m,k;case"L":case"H":case"V":return[i,m]=F(x,[t.x,t.y],d),l!==i&&u!==m?k=["L",i,m]:u===m?k=["H",i]:l===i&&(k=["V",m]),l=i,u=m,k;default:for(n=1,a=k.length;n<a;n+=2)[l,u]=F(x,[+k[n],+k[n+1]],d),k[n]=l,k[n+1]=u;return k}})}return c(h)}function G(t){return Array.isArray(t)&&u(t)&&t.slice(1).every(t=>"C"===t[0])}function J(t){if(G(t))return c(t);const e=v(t),r={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},n=[];let s="",a=e.length;for(let t=0;t<a;t+=1){const i=e[t],m=i.length;i&&([s]=i),n[t]=s,e[t]=V(i,r),$(e,n,t),a=e.length,r.x1=+i[m-2],r.y1=+i[m-1],r.x2=+i[m-4]||r.x1,r.y2=+i[m-3]||r.y1}return e}function U(t){if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0};const e=J(t);let r=0,n=0,s=[],a=[];e.forEach(t=>{const[e,i]=t.slice(-2).map(Number);if("M"===t[0])r=e,n=i,s.push(e),a.push(i);else{const m=function(t,e,r,n,s,a,i,m){let o=s-2*r+t-(i-2*s+r),c=2*(r-t)-2*(s-r),l=t-r,u=(-c+Math.sqrt(c*c-4*o*l))/2/o,h=(-c-Math.sqrt(c*c-4*o*l))/2/o;const f=[e,m],y=[t,i];let x;return Math.abs(u)>"1e12"&&(u=.5),Math.abs(h)>"1e12"&&(h=.5),u>0&&u<1&&(x=P(t,e,r,n,s,a,i,m,u),y.push(x.x),f.push(x.y)),h>0&&h<1&&(x=P(t,e,r,n,s,a,i,m,h),y.push(x.x),f.push(x.y)),o=a-2*n+e-(m-2*a+n),c=2*(n-e)-2*(a-n),l=e-n,u=(-c+Math.sqrt(c*c-4*o*l))/2/o,h=(-c-Math.sqrt(c*c-4*o*l))/2/o,Math.abs(u)>"1e12"&&(u=.5),Math.abs(h)>"1e12"&&(h=.5),u>0&&u<1&&(x=P(t,e,r,n,s,a,i,m,u),y.push(x.x),f.push(x.y)),h>0&&h<1&&(x=P(t,e,r,n,s,a,i,m,h),y.push(x.x),f.push(x.y)),{min:{x:Math.min.apply(0,y),y:Math.min.apply(0,f)},max:{x:Math.max.apply(0,y),y:Math.max.apply(0,f)}}}(r,n,...t.slice(1).map(Number));s=[...s,m.min.x,m.max.x],a=[...a,m.min.y,m.max.y],r=e,n=i}});const i=Math.min.apply(0,s),m=Math.min.apply(0,a),o=Math.max.apply(0,s),c=Math.max.apply(0,a),l=o-i,u=c-m;return{width:l,height:u,x:i,y:m,x2:o,y2:c,cx:i+l/2,cy:m+u/2}}function K(t){let e=0,r=0,n=0,s=0,a=0;return J(t).map(t=>{switch(t[0]){case"M":case"Z":return n="M"===t[0]?t[1]:n,s="M"===t[0]?t[2]:s,e=n,r=s,0;default:return a=function(t,e,r,n,s,a,i,m){return 3*((m-e)*(r+s)-(i-t)*(n+a)+n*(t-s)-r*(e-a)+m*(s+t/3)-i*(a+e/3))/20}(e,r,...t.slice(1).map(Number)),[e,r]=t.slice(-2).map(Number),a}}).reduce((t,e)=>t+e,0)}function W(t,e,r,n,s){return s*(s*(-3*t+9*e-9*r+3*n)+6*t-12*e+6*r)-3*t+3*e}function _(t,e,r,n,s,a,i,m,o){let c=o;(null===o||Number.isNaN(+o))&&(c=1),c>1&&(c=1),c<0&&(c=0);const l=c/2;let u=0,h=0,f=0,y=0;const x=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472];return[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816].forEach((o,c)=>{u=l*o+l,h=W(t,r,s,i,u),f=W(e,n,a,m,u),y+=x[c]*Math.sqrt(h*h+f*f)}),l*y}Object.assign(H,{Translate:j,Rotate:O,RotateAxisAngle:Q,Scale:Z,SkewX:D,SkewY:X,Multiply:Y,fromArray:L,fromMatrix:z,fromString:E});const tt={circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],rect:["width","height","x","y","rx","ry"],polygon:["points"],polyline:["points"],glyph:[]};const et={CSSMatrix:H,parsePathString:h,isPathArray:u,isCurveArray:G,isAbsoluteArray:f,isRelativeArray:x,isNormalizedArray:b,isValidPath:function(t){if("string"!=typeof t)return!1;const e=new l(t);for(i(e);e.index<e.max&&!e.err.length;)o(e);return!e.err.length&&"mM".includes(e.segments[0][0])},pathToAbsolute:y,pathToRelative:p,pathToCurve:J,pathToString:g,getDrawDirection:function(t){return K(J(t))>=0},getPathArea:K,getPathBBox:U,getPathLength:function(t){let e=0;return J(t).forEach((t,r,n)=>{const s=[...n[r-1].slice(-2),...t.slice(1)];e+="M"===t[0]?0:_(...s)}),e},getPointAtLength:function(t,e){let r,n,s,a=0;return J(t).map((t,i,m)=>{if(n=i?[...m[i-1].slice(-2),...t.slice(1)]:t.slice(1),r=i?_(...n):0,a+=r,0===i)s={x:n[0],y:n[1]};else if(a>e&&e>a-r){const t=[...n,1-(a-e)/r];s=P(...t)}else s=null;return s}).filter(t=>t).slice(-1)[0]},clonePath:c,splitPath:A,fixPath:function(t){const e=h(t),r=y(e),{length:n}=e,s="Z"===r.slice(-1)[0][0],a=s?n-2:n-1,[i,m]=r[0].slice(1),[o,c]=r[a].slice(1);return s&&i===o&&m===c?e.slice(0,-1):e},roundPath:d,optimizePath:C,reverseCurve:function(t){const e=t.slice(1).map((e,r,n)=>r?[...n[r-1].slice(-2),...e.slice(1)]:[...t[0].slice(1),...e.slice(1)]).map(t=>t.map((e,r)=>t[t.length-r-2*(1-r%2)])).reverse();return[["M",...e[0].slice(0,2).map(Number)],...e.map(t=>["C",...t.slice(2).map(Number)])]},reversePath:N,normalizePath:v,transformPath:B,getSVGMatrix:R,shapeToPath:function(e,r){const n=Object.keys(tt),s=e instanceof Element;if(s&&!n.some(t=>e.tagName===t))throw TypeError(`shapeToPath: "${e}" is not SVGElement`);const a=document.createElementNS("http://www.w3.org/2000/svg","path"),i=s?e.tagName:e.type,m={};if(m.type=i,s){const t=tt[i];t.forEach(t=>{m[t]=e.getAttribute(t)}),Object.values(e.attributes).forEach(({name:e,value:r})=>{t.includes(e)||a.setAttribute(e,r)})}else Object.assign(m,e);let o;const{round:c,decimals:l}=t,u=c&&l?l:null;return"circle"===i?o=g(function(t){const{cx:e,cy:r,r:n}=t;return[["M",e-n,r],["a",n,n,0,1,0,2*n,0],["a",n,n,0,1,0,-2*n,0]]}(m),u):"ellipse"===i?o=g(function(t){const{cx:e,cy:r,rx:n,ry:s}=t;return[["M",e-n,r],["a",n,s,0,1,0,2*n,0],["a",n,s,0,1,0,-2*n,0]]}(m),u):["polyline","polygon"].includes(i)?o=g(function(t){const e=[],r=t.points.split(/[\s|,]/).map(Number);let n=0;for(;n<r.length;)e.push([n?"L":"M",r[n],r[n+1]]),n+=2;return"polygon"===t.type?[...e,["z"]]:e}(m),u):"rect"===i?o=g(function(t){const e=+t.x||0,r=+t.y||0,n=+t.width,s=+t.height;let a=+t.rx,i=+t.ry;return a||i?(a=a||i,i=i||a,2*a>n&&(a-=(2*a-n)/2),2*i>s&&(i-=(2*i-s)/2),[["M",e+a,r],["h",n-2*a],["s",a,0,a,i],["v",s-2*i],["s",0,i,-a,i],["h",2*a-n],["s",-a,0,-a,-i],["v",2*i-s],["s",0,-i,a,-i]]):[["M",e,r],["h",n],["v",s],["H",e],["Z"]]}(m),u):"line"===i?o=g(function(t){const{x1:e,y1:r,x2:n,y2:s}=t;return[["M",e,r],["L",n,s]]}(m),u):"glyph"===i&&(o=s?e.getAttribute("d"):e.type),!!o&&(a.setAttribute("d",o),r&&s&&(e.before(a,e),e.remove()),a)},options:t,Version:"0.1.11alpha3"};class rt{constructor(e,r){const n=r||{};let{round:s}=t;const{round:a}=n;(a&&0==+a||!1===a)&&(s=0);const{decimals:i}=s?n||t:{decimals:!1};return this.round=i,this.segments=h(e),this.pathValue=e,this}toAbsolute(){const{segments:t}=this;return this.segments=y(t),this}toRelative(){const{segments:t}=this;return this.segments=p(t),this}reverse(t){this.toAbsolute();const{segments:e}=this,r=A(this.toString()),n=r.length>1?r:0,s=n&&c(n).map((e,r)=>t?r?N(e):h(e):N(e));let a=[];return a=n?s.flat(1):t?e:N(e),this.segments=c(a),this}normalize(){const{segments:t}=this;return this.segments=v(t),this}optimize(){const{segments:t}=this;return this.segments=C(t,this.round),this}transform(t){if(!t||"object"!=typeof t||"object"==typeof t&&!["translate","rotate","skew","scale"].some(e=>e in t))return this;const e={};Object.keys(t).forEach(r=>{e[r]=Array.isArray(t[r])?t[r].map(Number):Number(t[r])});const{segments:r}=this;if(!e.origin){const t=U(r),{cx:n,cy:s,width:a,height:i}=t,m=Math.max(a,i)+Math.min(a,i)/2;e.origin=[n,s,m]}return this.segments=B(r,e),this}flipX(){return this.transform({rotate:[180,0,0]}),this}flipY(){return this.transform({rotate:[0,180,0]}),this}toString(){return g(this.segments,this.round)}}Object.assign(rt,et);export{rt as default};
